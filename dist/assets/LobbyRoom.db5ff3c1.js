import{_ as ce,D as ve,a as O}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.70554d77.js";import{_ as G}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as r,c as S,M as fe,d as E,L as v,l as e,m as n,j as s,r as _,v as X,k as o,N as ee,h as te,i as m,K as _e,a as be,u as we,p as ge,q as ye,C,D as T,H as K,I as he,G as H,R as W}from"./index.5fcca771.js";import{_ as Y}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.c997a560.js";import{_ as M}from"./Flex.vue_vue_type_script_setup_true_lang.cc6ea895.js";import{_ as D}from"./InputField.vue_vue_type_script_setup_true_lang.94bbe422.js";import{_ as J,a as $e}from"./GridColItem.vue_vue_type_script_setup_true_lang.87eb0b33.js";import{M as F,a as ae,u as xe}from"./ModalSecondaryButton.1ba37829.js";import{_ as Me,S as Ce}from"./TableForm.vue_vue_type_script_setup_true_lang.5a4ae4a0.js";import{u as se}from"./TableStore.f7b4f8a2.js";import{u as ke,T as A}from"./PlayerStore.5432a49f.js";import{b as L,s as Te}from"./helpers.341acb79.js";import{R as Se}from"./RemoveButton.7bb3dca3.js";import{u as le,r as oe}from"./index.esm.3a6c68c9.js";import{_ as re}from"./ModalPrimaryButton.vue_vue_type_script_setup_true_lang.0bb71771.js";import{M as Pe}from"./MyTitle.99ada904.js";import{_ as Oe}from"./Alert.vue_vue_type_script_setup_true_lang.0439383d.js";import"./SelectField.vue_vue_type_script_setup_true_lang.df4b67ea.js";import"./CheckBoxField.vue_vue_type_script_setup_true_lang.7c206d54.js";import"./PreLoader.304fbb14.js";import"./axiosUser.5ea6112f.js";const Ae={},Le={class:"container 2xl:w-4/6 px-4 py-4"};function Re($,k){return r(),S("div",Le,[fe($.$slots,"default")])}const Q=G(Ae,[["render",Re]]),Be=E({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup($,{emit:k}){return se().fetchGames(),(w,g)=>(r(),v(F,{modalOpen:$.isModalOpen,onCloseModal:g[1]||(g[1]=c=>w.$emit("closeModal"))},{modal_header:e(()=>[n(" Create Table ")]),body:e(()=>[s(Me,{onCloseModal:g[0]||(g[0]=c=>w.$emit("closeModal"))})]),_:1},8,["modalOpen"]))}}),Ne=E({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup($,{emit:k}){const b=$,w=_({username:""});b.username&&(w.value.username=b.username);const g=X(()=>({username:{required:oe}})),c=le(g,w),x=()=>{c.value.$validate(),c.value.$error||k("registerGuest",w.value.username)};return(p,d)=>(r(),v(F,{modalOpen:$.isModalOpen,onCloseModal:d[4]||(d[4]=i=>p.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:e(()=>[n(" Set Nickname ")]),body:e(()=>[s(M,null,{default:e(()=>[s(D,{title:"Nickname",input:w.value.username,onChange:d[0]||(d[0]=i=>w.value.username=i),errors:o(c).username.$errors,onKeyup:d[1]||(d[1]=ee(i=>x(),["enter"]))},null,8,["input","errors"])]),_:1})]),modal_footer:e(()=>[s(ae,{onClick:d[2]||(d[2]=i=>p.$emit("closeModal"))},{default:e(()=>[n(" Close ")]),_:1}),s(re,{onClick:d[3]||(d[3]=i=>x())},{default:e(()=>[n(" Submit ")]),_:1})]),_:1},8,["modalOpen"]))}}),Ue=E({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup($,{emit:k}){const b=_({password:""}),w=X(()=>({password:{required:oe}})),g=le(w,b),c=()=>{g.value.$validate(),g.value.$error||k("setPasswordTable",b.value.password)};return(x,p)=>(r(),v(F,{modalOpen:$.isModalOpen,onCloseModal:p[4]||(p[4]=d=>x.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:e(()=>[n(" Password Table ")]),body:e(()=>[s(M,null,{default:e(()=>[s(D,{title:"Table Password",input:b.value.password,onChange:p[0]||(p[0]=d=>b.value.password=d),errors:o(g).password.$errors,onKeyup:p[1]||(p[1]=ee(d=>c(),["enter"]))},null,8,["input","errors"])]),_:1})]),modal_footer:e(()=>[s(ae,{onClick:p[2]||(p[2]=d=>x.$emit("closeModal"))},{default:e(()=>[n("Close")]),_:1}),s(re,{onClick:p[3]||(p[3]=d=>c())},{default:e(()=>[n("Submit")]),_:1})]),_:1},8,["modalOpen"]))}}),Ze={},Ie={class:"fixed bottom-0 left-0 w-full bg-primary py-3 px-8 text-white"};function Ve($,k){const b=te("RouterLink");return r(),S("div",Ie,[n(" ***Note: If you would like to create your own game, we kindly ask you to create a "),s(b,{to:{name:"register"},class:"underline"},{default:e(()=>[n("real account")]),_:1}),n(". This will give you full access to all the features and tools you need to bring your game to life. real account. ")])}const Ee=G(Ze,[["render",Ve]]),je={},ze={type:"button",class:"rounded-md border border-transparent bg-primary text-white px-8 font-medium hover:bg-secondary md:py-1 md:px-3 transition duration-150 text-2xl flex justify-center items-center"},He=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"#FFF",class:"w-7 h-6",viewBox:"0 0 16 16"},[m("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),m("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})],-1),Ge=[He];function De($,k){return r(),S("button",ze,Ge)}const Fe=G(je,[["render",De]]),qe={class:"text-primary font-bold"},Ke=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-primary h-8 w-8",viewBox:"0 0 16 16"},[m("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),We={class:"text-primary"},Ye=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-[#cc6514] h-8 w-8",viewBox:"0 0 16 16"},[m("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Je={class:"text-[#cc6514]"},Qe={key:0},Xe=m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[m("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),et=[Xe],tt={key:1},at=m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[m("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),st=[at],Ct=E({__name:"LobbyRoom",setup($){const{width:k,height:b}=xe(),w=_(parseInt("600")),g=_(parseInt("1000")),c=_(!1),x=_(!1),p=_(0),d=_e(),i=be(),y=_([]),R=_([]),j=we(),u=ke(),ne=se(),I=_(""),z=_(!1),N=_({countInRoomUsers:0,countOnlineUsers:0});ge(()=>{i.user.id||(c.value=!0),L.emit("getAllOnlineTable",{},l=>{var t;y.value=R.value=(t=l.tables)!=null?t:[],N.value=l.countUsers}),L.on("getLastGame",l=>{u.leaverPlayer.table=u.table={...l}}),L.on("getUsersOnline",l=>{N.value=l}),L.on("getOnlineTable",l=>{l.table_users=[],y.value.unshift(l)}),L.on("getRemoveTable",l=>{y.value=R.value=y.value.filter(t=>t.id!==l)}),L.on("getTableUsers",l=>{var h;const t=y.value.map(a=>a.id).indexOf(l.id);t!==-1&&(y.value[t].table_users=(h=l.table_users)!=null?h:null)}),L.on("getUpdateTable",l=>{const t=y.value.map(h=>h.id).indexOf(l==null?void 0:l.id);t===-1?y.value.push(l):l.status===A.FINISH?y.value.splice(t,1):y.value[t]=l,R.value=y.value.filter(h=>h.name.toLocaleLowerCase().includes(I.value.toLocaleLowerCase()))})});const q=l=>{var t,h,a,P,U;if(u.table=l,u.table){if(!i.user.id){c.value=!0;return}u.table.private?x.value=!0:((t=u.table.game)==null?void 0:t.max_players)&&((h=u.table)==null?void 0:h.table_users)&&(((P=(a=u.table)==null?void 0:a.table_users)==null?void 0:P.length)<((U=u.table.game)==null?void 0:U.max_players)?(u.leaverPlayer.table=null,d.push({name:"room",params:{id:u.table.public_url}})):j.error("The table is full"))}},ue=async l=>{await u._validateTablePassword(l).then(t=>{t.status===200?u.table&&(x.value=!1,d.push({name:"room",params:{id:u.table.public_url}})):(x.value=!1,j.error("Wrong Password"))})},ie=()=>{ne.games.length===0?j.warning("You have to create a game first"):z.value=!0},de=_(["Table","Game","Players","Private","creator","status"]),V=_(-1),me=l=>{i.registerGuest(l).then(()=>{c.value=!1,Te(i.user.id)})},pe=(l,t)=>{V.value===l?(V.value=-1,u.table=null):(V.value=l,u.table={...t})};return ye(()=>I.value,l=>{R.value=y.value.filter(t=>t.name.toLocaleLowerCase().includes(l.toLocaleLowerCase()))}),(l,t)=>{const h=te("VTooltip");return r(),S(K,null,[o(k)>g.value&&o(b)>w.value?(r(),v(Q,{key:0},{default:e(()=>[s(M,{justify:"between",items:"end",class:"mb-4"},{default:e(()=>[s(Pe,null,{default:e(()=>[n("Lobby")]),_:1}),o(i).user.email===null?(r(),S("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:t[0]||(t[0]=a=>c.value=!0)},C(o(i).user.username?"Change Nickname":"Add Nickname"),1)):T("",!0)]),_:1}),o(u).leaverPlayer.table?(r(),v(M,{key:0,justify:"between",items:"center",class:"p-4 bg-dark text-white rounded-xl mb-6 text-lg"},{default:e(()=>[m("div",null,[n(" Previous game: "),m("span",qe,C(o(u).leaverPlayer.table.name),1)]),m("div",null,[o(u).leaverPlayer&&o(u).leaverPlayer.table?(r(),v(Y,{key:0,title:"Resume Game",onClick:t[1]||(t[1]=a=>q(o(u).leaverPlayer.table))})):T("",!0)])]),_:1})):T("",!0),N.value?(r(),v(M,{key:1,justify:"center",class:"mt-3 p-4 text-xl",gap:8},{default:e(()=>[s(M,{items:"center",gap:2},{default:e(()=>[Ke,m("div",null,[n(" Users Online: "),m("span",We,C(N.value.countOnlineUsers),1)])]),_:1}),s(M,{items:"center",gap:2},{default:e(()=>[Ye,m("div",null,[n(" Users in game: "),m("span",Je,C(N.value.countInRoomUsers),1)])]),_:1})]),_:1})):T("",!0),s($e,{all:2,class:"my-3 px-2"},{default:e(()=>[s(J,{all:1},{default:e(()=>[s(D,{input:I.value,placeholder:"Search a Table..",onChange:t[2]||(t[2]=a=>I.value=a)},null,8,["input","placeholder"])]),_:1}),s(J,{all:1},{default:e(()=>[s(M,{justify:"end",gap:2},{default:e(()=>[o(i).user.role!==o(W).guest?(r(),v(Y,{key:0,title:"Create Table",onClick:t[3]||(t[3]=a=>ie())})):T("",!0)]),_:1})]),_:1})]),_:1}),R.value.length>0?(r(),v(ce,{key:2,"table-headers":de.value,class:"max-h-[490px] overflow-x-auto",actions:!0},{default:e(()=>[(r(!0),S(K,null,he(R.value,(a,P)=>{var U;return r(),v(ve,{key:`lobby-row-${a.id}`,class:H(["cursor-pointer transition duration-1000",[V.value===P?"bg-gray-700":"",((U=a.creator)==null?void 0:U.id)===o(i).user.id?"bg-[#222]":""]]),onClick:Z=>pe(P,a),onMouseover:Z=>p.value=P,onMouseleave:t[5]||(t[5]=Z=>p.value=-1)},{default:e(()=>{var Z;return[s(O,{class:"w-2/12"},{default:e(()=>[n(C(a.name),1)]),_:2},1024),s(O,{class:"w-2/12"},{default:e(()=>{var f;return[n(C((f=a.game)==null?void 0:f.name),1)]}),_:2},1024),s(O,{class:"w-1/12"},{default:e(()=>{var f,B;return[n(C((f=a.table_users)!=null&&f.length?a.table_users.length:0)+" / "+C((B=a.game)==null?void 0:B.max_players),1)]}),_:2},1024),s(O,{class:"w-1/12"},{default:e(()=>[s(M,null,{default:e(()=>[a.private?(r(),S("div",Qe,et)):(r(),S("div",tt,st))]),_:2},1024)]),_:2},1024),s(O,{class:H(["w-2/12",((Z=a.creator)==null?void 0:Z.id)===o(i).user.id?"text-primary":""])},{default:e(()=>{var f;return[n(C((f=a.creator)==null?void 0:f.username),1)]}),_:2},1032,["class"]),s(O,{class:H(["w-2/12 capitalize",[a.status===o(A).WAITING?"text-blue-500":"",a.status===o(A).PLAYING?"text-primary":"",a.status===o(A).PLAYER_DISCONNECTED||a.status===o(A).PLAYER_LEAVE?"text-red-500":"",a.status===o(A).PAUSE||a.status===o(A).GAME_MASTER_EDIT?"text-orange-500":""]])},{default:e(()=>{var f;return[n(C(((f=o(Ce).find(B=>B.id===a.status))==null?void 0:f.name)||"Unknown"),1)]}),_:2},1032,["class"]),s(O,{class:"w-2/2"},{default:e(()=>[s(M,{gap:2,class:"w-full",justify:"center"},{default:e(()=>{var f;return[s(h,null,{popper:e(()=>[n(" Join Table ")]),default:e(()=>[s(Fe,{onClick:B=>q(a)},null,8,["onClick"])]),_:2},1024),p.value===P&&((f=a.creator)==null?void 0:f.id)===o(i).user.id?(r(),v(h,{key:0},{popper:e(()=>[n(" Remove Table ")]),default:e(()=>[s(Se,{onClick:t[4]||(t[4]=B=>o(u)._removeTable())})]),_:1})):T("",!0)]}),_:2},1024)]),_:2},1024)]}),_:2},1032,["onClick","class","onMouseover"])}),128))]),_:1},8,["table-headers"])):(r(),v(Oe,{key:3,class:"mt-10"},{default:e(()=>[n(" No available tables to join. Create a table to start a game! ")]),_:1}))]),_:1})):(r(),v(Q,{key:1},{default:e(()=>[s(M,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:e(()=>[n(" The game is supported on desktop computers ")]),_:1})]),_:1})),o(i).user.role!==o(W).guest?(r(),v(Be,{key:2,"is-modal-open":z.value,onCloseModal:t[6]||(t[6]=()=>z.value=!1)},null,8,["is-modal-open"])):T("",!0),s(Ne,{"is-modal-open":c.value,username:o(i).user.username?o(i).user.username:"",onCloseModal:t[7]||(t[7]=a=>c.value=!1),onRegisterGuest:t[8]||(t[8]=a=>me(a))},null,8,["is-modal-open","username"]),s(Ue,{"is-modal-open":x.value,onCloseModal:t[9]||(t[9]=a=>x.value=!1),onSetPasswordTable:t[10]||(t[10]=a=>ue(a))},null,8,["is-modal-open"]),o(i).isGuest?(r(),v(Ee,{key:3})):T("",!0)],64)}}});export{Ct as default};
