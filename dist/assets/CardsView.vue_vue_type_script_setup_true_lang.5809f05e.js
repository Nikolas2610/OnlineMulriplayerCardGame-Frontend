import{_ as I}from"./CardForm.vue_vue_type_script_setup_true_lang.9c0d4b9d.js";import{M as D}from"./MyTitle.e8fe9939.js";import{a as x}from"./axiosUser.bc979347.js";import{a as R,M as A}from"./ModalSecondaryButton.ea03128a.js";import{d as O,a as P,a4 as j,r as o,u as L,b as U,o as i,c as d,i as e,j as l,l as n,m as _,H as C,I as M,C as y,k as G}from"./index.542ccea8.js";import{l as H}from"./helpers.2772eae0.js";import{_ as Y}from"./Flex.vue_vue_type_script_setup_true_lang.84cb6120.js";import{_ as q}from"./BackButton.vue_vue_type_script_setup_true_lang.8fc59e6b.js";import{_ as z}from"./ModalPrimaryButton.vue_vue_type_script_setup_true_lang.422fbacc.js";const J={class:"w-full overflow-x-auto px-4"},K={key:0},Q={class:"mx-auto my-4"},W={class:"flex flex-col"},X={class:"overflow-x-auto shadow-md sm:rounded-lg"},Z={class:"inline-block min-w-full align-middle"},ee={class:"overflow-hidden"},te={class:"min-w-full divide-y table-fixed divide-gray-700"},ae={class:"bg-gray-700"},se=e("th",{scope:"col",class:"p-4"},[e("span",{class:"sr-only"},"Edit")],-1),oe={class:"divide-y bg-dark divide-gray-700"},le={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},ne={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},re={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},ie=["src","alt"],de={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},ce={class:"py-4 px-6 text-sm font-medium text-right whitespace-nowrap"},ue=["onClick"],me=["onClick"],pe={key:1},_e=e("div",null," Do you really want to delete this card? This process cannot be undone ",-1),Me=O({__name:"CardsView",setup(fe){const $=P(),S=j(),f=o("user"),c=L(),m=o(!1),p=o([]),w=o(),v=o(null),k=o(),h=o(!1),E=o(-1),B=o(["No","NAME","IMAGE","PRIVATE"]);U(async()=>{S.meta.admin&&(f.value=$.$state.user.role),g()});const b=()=>{m.value=!1},g=async()=>{try{const t=await x.get(`${f.value}/cards`);p.value=t.data}catch(t){console.log(t)}},F=t=>{w.value={...p.value[t]},k.value=w.value.image,v.value=p.value[t].id,h.value=!0},N=t=>{v.value=p.value[t].id,m.value=!0},T=async()=>{try{if(v.value){if((await x.delete(f.value==="admin"?"admin/card":"card",{data:{card_id:v.value}})).data.affected===1){c.success("Card deleted successfully"),m.value=!1,g();return}c.error("Something went wrong. Please try again later")}}catch(t){c.error(t.response.data.error),m.value=!1}},V=async(t,u,s)=>{try{let a="";const r=new FormData;if(u.file&&(r.append("image",u.file,u.name),a="/image"),r.append("id",s.id.toString()),r.append("name",t.name),r.append("private",t.private.toString()),(await x.patch(f.value==="admin"?`admin/card${a}`:`card${a}`,r,{headers:{"Content-Type":"multipart/form-data"}})).status===200){c.success("Card updated successfully"),g(),h.value=!1;return}c.error("Something went wrong. Please try again later")}catch(a){c.error("Something went wrong. Please try again later",a)}};return(t,u)=>(i(),d(C,null,[e("div",J,[h.value?(i(),d("div",pe,[l(Y,{justify:"between"},{default:n(()=>[l(D,null,{default:n(()=>[_("Edit Card")]),_:1}),l(q,{title:"Back to Cards",onClick:u[0]||(u[0]=s=>h.value=!1)})]),_:1}),l(I,{onSendData:V,successResponse:E.value,cardData:w.value,imageFile:k.value,edit:!0},null,8,["successResponse","cardData","imageFile"])])):(i(),d("div",K,[l(D,null,{default:n(()=>[_("My Cards")]),_:1}),e("div",Q,[e("div",W,[e("div",X,[e("div",Z,[e("div",ee,[e("table",te,[e("thead",ae,[e("tr",null,[(i(!0),d(C,null,M(B.value,(s,a)=>(i(),d("th",{scope:"col",key:a,class:"py-3 px-6 text-xs font-medium tracking-wider text-left uppercase text-gray-400"},y(s),1))),128)),se])]),e("tbody",oe,[(i(!0),d(C,null,M(p.value,(s,a)=>(i(),d("tr",{class:"hover:bg-gray-700",key:`gamme_${s.id}`},[e("td",le,y(a+1),1),e("td",ne,y(s.name),1),e("td",re,[e("img",{src:G(H)(s.image),alt:s.name,class:"w-20 h-32"},null,8,ie)]),e("td",de,y(s.private?"YES":"NO"),1),e("td",ce,[e("button",{class:"text-blue-500 hover:underline",onClick:r=>F(a)}," View Details ",8,ue),e("button",{class:"text-red-500 hover:underline ml-2",onClick:r=>N(a)}," Delete ",8,me)])]))),128))])])])])])])])]))]),l(A,{modalOpen:m.value,onCloseModal:b},{modal_header:n(()=>[_(" Are you sure? ")]),body:n(()=>[_e]),modal_footer:n(()=>[l(R,{onClick:b},{default:n(()=>[_(" Close ")]),_:1}),l(z,{onClick:T,deleteButton:!0},{default:n(()=>[_(" Delete ")]),_:1})]),_:1},8,["modalOpen"])],64))}});export{Me as _};
