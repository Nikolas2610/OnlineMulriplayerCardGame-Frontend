import{_ as ne,D as ue,a as L}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.6cece63c.js";import{_ as W}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as n,c as O,M as ie,d as B,L as _,l as s,m as u,j as l,r as v,v as Y,k as r,h as de,K as me,a as pe,u as ce,p as fe,q as ve,C,D as k,i as p,H as z,I as _e,G as j,R as D}from"./index.e95d5f3b.js";import{_ as V}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.0920ccac.js";import{_ as h}from"./Flex.vue_vue_type_script_setup_true_lang.2447bbeb.js";import{_ as E}from"./InputField.vue_vue_type_script_setup_true_lang.5be8a812.js";import{_ as q,a as be}from"./GridColItem.vue_vue_type_script_setup_true_lang.53eb0f03.js";import{M as G,a as J,u as ge}from"./ModalSecondaryButton.07737cf3.js";import{_ as we,S as ye}from"./TableForm.vue_vue_type_script_setup_true_lang.deed92ce.js";import{u as K}from"./TableStore.207994b3.js";import{u as Me,T}from"./PlayerStore.a2105743.js";import{b as S,s as $e}from"./helpers.bd0f080e.js";import{R as Ce}from"./RemoveButton.fe80503b.js";import{u as Q,r as X}from"./index.esm.09ec47b5.js";import{_ as ee}from"./ModalPrimaryButton.vue_vue_type_script_setup_true_lang.3df717cf.js";import{M as he}from"./MyTitle.2ddde86c.js";import"./SelectField.vue_vue_type_script_setup_true_lang.3eb54eec.js";import"./CheckBoxField.vue_vue_type_script_setup_true_lang.19d2f65f.js";import"./PreLoader.9dc694ab.js";import"./axiosUser.b9d2e0f3.js";const xe={},ke={class:"container 2xl:w-4/6 px-4 py-4"};function Te(y,x){return n(),O("div",ke,[ie(y.$slots,"default")])}const F=W(xe,[["render",Te]]),Se=B({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup(y,{emit:x}){return K().fetchGames(),(g,w)=>(n(),_(G,{modalOpen:y.isModalOpen,onCloseModal:w[1]||(w[1]=c=>g.$emit("closeModal"))},{modal_header:s(()=>[u(" Create Table ")]),body:s(()=>[l(we,{onCloseModal:w[0]||(w[0]=c=>g.$emit("closeModal"))})]),_:1},8,["modalOpen"]))}}),Oe=B({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup(y,{emit:x}){const b=y,g=v({username:""});b.username&&(g.value.username=b.username);const w=Y(()=>({username:{required:X}})),c=Q(w,g),M=()=>{c.value.$validate(),c.value.$error||x("registerGuest",g.value.username)};return(f,o)=>(n(),_(G,{modalOpen:y.isModalOpen,onCloseModal:o[3]||(o[3]=m=>f.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:s(()=>[u(" Set Nickname ")]),body:s(()=>[l(h,null,{default:s(()=>[l(E,{title:"Nickname",input:g.value.username,onChange:o[0]||(o[0]=m=>g.value.username=m),errors:r(c).username.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:s(()=>[l(J,{onClick:o[1]||(o[1]=m=>f.$emit("closeModal"))},{default:s(()=>[u(" Close ")]),_:1}),l(ee,{onClick:o[2]||(o[2]=m=>M())},{default:s(()=>[u(" Submit ")]),_:1})]),_:1},8,["modalOpen"]))}}),Pe=B({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup(y,{emit:x}){const b=v({password:""}),g=Y(()=>({password:{required:X}})),w=Q(g,b),c=()=>{w.value.$validate(),w.value.$error||x("setPasswordTable",b.value.password)};return(M,f)=>(n(),_(G,{modalOpen:y.isModalOpen,onCloseModal:f[3]||(f[3]=o=>M.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:s(()=>[u(" Password Table ")]),body:s(()=>[l(h,null,{default:s(()=>[l(E,{title:"Table Password",input:b.value.password,onChange:f[0]||(f[0]=o=>b.value.password=o),errors:r(w).password.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:s(()=>[l(J,{onClick:f[1]||(f[1]=o=>M.$emit("closeModal"))},{default:s(()=>[u("Close")]),_:1}),l(ee,{onClick:f[2]||(f[2]=o=>c())},{default:s(()=>[u("Submit")]),_:1})]),_:1},8,["modalOpen"]))}}),Le={},Ae={class:"fixed bottom-0 left-0 w-full bg-primary py-3 px-8 text-white"};function Re(y,x){const b=de("RouterLink");return n(),O("div",Ae,[u(" ***Note: If you would like to create your own game, we kindly ask you to create a "),l(b,{to:{name:"register"},class:"underline"},{default:s(()=>[u("real account")]),_:1}),u(". This will give you full access to all the features and tools you need to bring your game to life. real account. ")])}const Ue=W(Le,[["render",Re]]),Ze={class:"text-primary font-bold"},Be=p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-primary h-8 w-8",viewBox:"0 0 16 16"},[p("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Ie={class:"text-primary"},Ne=p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-[#cc6514] h-8 w-8",viewBox:"0 0 16 16"},[p("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Ve={class:"text-[#cc6514]"},Ee={key:0},Ge=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[p("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),He=[Ge],ze={key:1},je=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[p("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),De=[je],pa=B({__name:"LobbyRoom",setup(y){const{width:x,height:b}=ge(),g=v(parseInt("600")),w=v(parseInt("1000")),c=v(!1),M=v(!1),f=me(),o=pe(),m=v([]),P=v([]),I=ce(),i=Me(),ae=K(),U=v(""),N=v(!1),A=v({countInRoomUsers:0,countOnlineUsers:0});fe(()=>{o.user.id||(c.value=!0),S.emit("getAllOnlineTable",{},t=>{m.value=P.value=t.tables,A.value=t.countUsers}),S.on("getLastGame",t=>{i.leaverPlayer.table=i.table={...t}}),S.on("getUsersOnline",t=>{A.value=t}),S.on("getOnlineTable",t=>{t.table_users=[],m.value.unshift(t)}),S.on("getRemoveTable",t=>{m.value=P.value=m.value.filter(e=>e.id!==t)}),S.on("getTableUsers",t=>{var a;const e=m.value.map($=>$.id).indexOf(t.id);e!==-1&&(m.value[e].table_users=(a=t.table_users)!=null?a:null)}),S.on("getUpdateTable",t=>{const e=m.value.map(a=>a.id).indexOf(t==null?void 0:t.id);e===-1?m.value.push(t):t.status===T.FINISH?m.value.splice(e,1):m.value[e]=t,P.value=m.value.filter(a=>a.name.toLocaleLowerCase().includes(U.value.toLocaleLowerCase()))})});const H=()=>{var t,e,a,$,d;if(i.table){if(!o.user.id){c.value=!0;return}i.table.private?M.value=!0:((t=i.table.game)==null?void 0:t.max_players)&&((e=i.table)==null?void 0:e.table_users)&&((($=(a=i.table)==null?void 0:a.table_users)==null?void 0:$.length)<((d=i.table.game)==null?void 0:d.max_players)?(i.leaverPlayer.table=null,f.push({name:"room",params:{id:i.table.public_url}})):I.error("The table is full"))}},se=async t=>{await i._validateTablePassword(t).then(e=>{e.status===200?i.table&&(M.value=!1,f.push({name:"room",params:{id:i.table.public_url}})):(M.value=!1,I.error("Wrong Password"))})},te=()=>{ae.games.length===0?I.warning("You have to create a game first"):N.value=!0},le=v(["Table","Game","Players","Private","creator","status"]),R=v(-1),oe=t=>{o.registerGuest(t).then(()=>{c.value=!1,$e(o.user.id)})},re=(t,e)=>{R.value===t?(R.value=-1,i.table=null):(R.value=t,i.table={...e})};return ve(()=>U.value,t=>{P.value=m.value.filter(e=>e.name.toLocaleLowerCase().includes(t.toLocaleLowerCase()))}),(t,e)=>(n(),O(z,null,[r(x)>w.value&&r(b)>g.value?(n(),_(F,{key:0},{default:s(()=>[l(h,{justify:"between",items:"end",class:"mb-4"},{default:s(()=>[l(he,null,{default:s(()=>[u("Lobby")]),_:1}),r(o).user.email===null?(n(),O("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:e[0]||(e[0]=a=>c.value=!0)},C(r(o).user.username?"Change Nickname":"Add Nickname"),1)):k("",!0)]),_:1}),r(i).leaverPlayer.table?(n(),_(h,{key:0,justify:"between",items:"center",class:"p-4 bg-dark text-white rounded-xl mb-6 text-lg"},{default:s(()=>[p("div",null,[u(" Previous game: "),p("span",Ze,C(r(i).leaverPlayer.table.name),1)]),p("div",null,[l(V,{title:"Resume Game",onClick:e[1]||(e[1]=a=>H())})])]),_:1})):k("",!0),A.value?(n(),_(h,{key:1,justify:"center",class:"mt-3 p-4 text-xl",gap:8},{default:s(()=>[l(h,{items:"center",gap:2},{default:s(()=>[Be,p("div",null,[u(" Users Online: "),p("span",Ie,C(A.value.countOnlineUsers),1)])]),_:1}),l(h,{items:"center",gap:2},{default:s(()=>[Ne,p("div",null,[u(" Users in game: "),p("span",Ve,C(A.value.countInRoomUsers),1)])]),_:1})]),_:1})):k("",!0),l(be,{all:2,class:"my-3 px-2"},{default:s(()=>[l(q,{all:1},{default:s(()=>[l(E,{input:U.value,placeholder:"Search a Table..",onChange:e[2]||(e[2]=a=>U.value=a)},null,8,["input","placeholder"])]),_:1}),l(q,{all:1},{default:s(()=>[l(h,{justify:"end",gap:2},{default:s(()=>{var a,$;return[(($=(a=r(i).table)==null?void 0:a.creator)==null?void 0:$.id)===r(o).user.id?(n(),_(Ce,{key:0,onClick:e[3]||(e[3]=d=>r(i)._removeTable())})):k("",!0),r(o).user.role!==r(D).guest?(n(),_(V,{key:1,title:"Create Table",onClick:e[4]||(e[4]=d=>te())})):k("",!0),l(V,{title:"Join Table",disable:R.value===-1,onClick:e[5]||(e[5]=d=>H())},null,8,["disable"])]}),_:1})]),_:1})]),_:1}),P.value.length>0?(n(),_(ne,{key:2,"table-headers":le.value,class:"max-h-[490px] overflow-x-auto"},{default:s(()=>[(n(!0),O(z,null,_e(P.value,(a,$)=>(n(),_(ue,{key:`lobby-row-${a.id}`,onClick:d=>re($,a),class:j(R.value===$?"bg-gray-700":"")},{default:s(()=>[l(L,null,{default:s(()=>[u(C(a.name),1)]),_:2},1024),l(L,null,{default:s(()=>{var d;return[u(C((d=a.game)==null?void 0:d.name),1)]}),_:2},1024),l(L,null,{default:s(()=>{var d,Z;return[u(C((d=a.table_users)!=null&&d.length?a.table_users.length:0)+" / "+C((Z=a.game)==null?void 0:Z.max_players),1)]}),_:2},1024),l(L,null,{default:s(()=>[l(h,null,{default:s(()=>[a.private?(n(),O("div",Ee,He)):(n(),O("div",ze,De))]),_:2},1024)]),_:2},1024),l(L,null,{default:s(()=>{var d;return[u(C((d=a.creator)==null?void 0:d.username),1)]}),_:2},1024),l(L,{class:j([[a.status===r(T).WAITING?"text-blue-500":"",a.status===r(T).PLAYING?"text-primary":"",a.status===r(T).PLAYER_DISCONNECTED||a.status===r(T).PLAYER_LEAVE?"text-red-500":"",a.status===r(T).PAUSE||a.status===r(T).GAME_MASTER_EDIT?"text-orange-500":""],"capitalize"])},{default:s(()=>{var d;return[u(C(((d=r(ye).find(Z=>Z.id===a.status))==null?void 0:d.name)||"Unknown"),1)]}),_:2},1032,["class"])]),_:2},1032,["onClick","class"]))),128))]),_:1},8,["table-headers"])):k("",!0)]),_:1})):(n(),_(F,{key:1},{default:s(()=>[l(h,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:s(()=>[u(" The game is supported on desktop computers ")]),_:1})]),_:1})),r(o).user.role!==r(D).guest?(n(),_(Se,{key:2,"is-modal-open":N.value,onCloseModal:e[6]||(e[6]=()=>N.value=!1)},null,8,["is-modal-open"])):k("",!0),l(Oe,{"is-modal-open":c.value,username:r(o).user.username?r(o).user.username:"",onCloseModal:e[7]||(e[7]=a=>c.value=!1),onRegisterGuest:e[8]||(e[8]=a=>oe(a))},null,8,["is-modal-open","username"]),l(Pe,{"is-modal-open":M.value,onCloseModal:e[9]||(e[9]=a=>M.value=!1),onSetPasswordTable:e[10]||(e[10]=a=>se(a))},null,8,["is-modal-open"]),r(o).isGuest?(n(),_(Ue,{key:3})):k("",!0)],64))}});export{pa as default};
