import{_ as Z,D as ee,a as h}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.42c3d763.js";import{_ as te}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as n,c as M,M as ae,d as B,L as w,k as t,l as y,i as l,e as p,v as H,j as o,h as x,K as se,a as le,u as re,n as oe,p as ne,C,D as P,H as z,I as ue,G as I,R as A}from"./index.bcf80a2f.js";import{_ as T,a as U}from"./CheckBoxField.vue_vue_type_script_setup_true_lang.2aa7e07e.js";import{_ as L}from"./InputField.vue_vue_type_script_setup_true_lang.d407afcf.js";import{_ as q,R as ie,a as de}from"./RemoveButton.f7883173.js";import{M as R,u as me}from"./Modal.d313a94f.js";import{_ as pe}from"./TableForm.vue_vue_type_script_setup_true_lang.3f45fd06.js";import{u as fe}from"./TableStore.389ef0f8.js";import{u as ve,s as G,T as j}from"./socket.6a62d68f.js";import{u as W,r as E}from"./index.esm.c1706187.js";import{M as be}from"./MyTitle.56a96242.js";import"./PreLoader.2916c6e6.js";import"./axiosUser.82c59d05.js";const ce={},_e={class:"container 2xl:w-4/6 px-4 py-4"};function we(g,$){return n(),M("div",_e,[ae(g.$slots,"default")])}const D=te(ce,[["render",we]]),ye=B({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup(g,{emit:$}){return fe().fetchGames(),(f,b)=>(n(),w(R,{modalOpen:g.isModalOpen,onCloseModal:b[0]||(b[0]=i=>f.$emit("closeModal"))},{modal_header:t(()=>[y(" Create Table ")]),body:t(()=>[l(pe)]),_:1},8,["modalOpen"]))}}),ge=B({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup(g,{emit:$}){const v=g,f=p({username:""});v.username&&(f.value.username=v.username);const b=H(()=>({username:{required:E}})),i=W(b,f),c=()=>{i.value.$validate(),i.value.$error||$("registerGuest",f.value.username)};return(u,s)=>(n(),w(R,{modalOpen:g.isModalOpen,onCloseModal:s[3]||(s[3]=d=>u.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[y(" Set Nickname ")]),body:t(()=>[l(T,null,{default:t(()=>[l(L,{title:"Nickname",input:f.value.username,onChange:s[0]||(s[0]=d=>f.value.username=d),errors:o(i).username.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[x("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:s[1]||(s[1]=d=>u.$emit("closeModal"))}," Close "),x("button",{onClick:s[2]||(s[2]=d=>c()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),xe=B({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup(g,{emit:$}){const v=p({password:""}),f=H(()=>({password:{required:E}})),b=W(f,v),i=()=>{b.value.$validate(),b.value.$error||$("setPasswordTable",v.value.password)};return(c,u)=>(n(),w(R,{modalOpen:g.isModalOpen,onCloseModal:u[3]||(u[3]=s=>c.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[y(" Password Table ")]),body:t(()=>[l(T,null,{default:t(()=>[l(L,{title:"Table Password",input:v.value.password,onChange:u[0]||(u[0]=s=>v.value.password=s),errors:o(b).password.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[x("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:u[1]||(u[1]=s=>c.$emit("closeModal"))}," Close "),x("button",{onClick:u[2]||(u[2]=s=>i()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),$e={key:0},he=x("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[x("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),Ce=[he],Me={key:1},Te=x("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[x("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),ke=[Te],qe=B({__name:"LobbyRoom",setup(g){const{width:$,height:v}=me(),f=p(parseInt("600")),b=p(parseInt("1000")),i=p(!1),c=p(!1),u=se(),s=le(),d=p([]),k=p([]),F=re(),_=ve(),N=p(""),V=p(!1);oe(()=>{s.user.id||(i.value=!0),G.emit("findAllOnlineTable",{},r=>{d.value=k.value=r}),G.on("addNewTable",r=>{r.table_users=[],d.value.unshift(r)}),G.on("removeOldTable",r=>{d.value=k.value=d.value.filter(e=>e.id!==r)}),G.on("getTableUsers",r=>{const e=d.value.map(a=>a.id).indexOf(r.id);e!==-1&&(d.value[e].table_users=r.table_users)})});const J=()=>{if(_.table){if(!s.user.id){i.value=!0;return}_.table.private?c.value=!0:u.push({name:"room",params:{id:_.table.public_url}})}},K=async r=>{await _._validateTablePassword(r).then(e=>{e.status===200?_.table&&(c.value=!1,u.push({name:"room",params:{id:_.table.public_url}})):(c.value=!1,F.error("Wrong Password"))})},Y=p(["Table","Game","Players","Private","creator","status"]),S=p(-1),Q=r=>{s.registerGuest(r).then(()=>{i.value=!1})},X=(r,e)=>{S.value===r?(S.value=-1,_.table=null):(S.value=r,_.table=e)};return ne(()=>N.value,r=>{k.value=d.value.filter(e=>e.name.toLocaleLowerCase().includes(r.toLocaleLowerCase()))}),(r,e)=>(n(),M(z,null,[o($)>b.value&&o(v)>f.value?(n(),w(D,{key:0},{default:t(()=>[l(T,{justify:"between",items:"end",class:"mb-8"},{default:t(()=>[l(be,null,{default:t(()=>[y("Lobby")]),_:1}),o(s).user.email===null?(n(),M("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:e[0]||(e[0]=a=>i.value=!0)},C(o(s).user.username?"Change Nickname":"Add Nickname"),1)):P("",!0)]),_:1}),l(de,{all:2,class:"mt-3 px-2"},{default:t(()=>[l(q,{all:1},{default:t(()=>[l(L,{input:N.value,placeholder:"Search a Table..",onChange:e[1]||(e[1]=a=>N.value=a)},null,8,["input","placeholder"])]),_:1}),l(q,{all:1},{default:t(()=>[l(T,{justify:"center",gap:2},{default:t(()=>{var a,O;return[o(s).user.role!==o(A).guest?(n(),w(U,{key:0,title:"Create Table",onClick:e[2]||(e[2]=m=>V.value=!0)})):P("",!0),l(U,{title:"Join Table",disable:S.value===-1,onClick:e[3]||(e[3]=m=>J())},null,8,["disable"]),((O=(a=o(_).table)==null?void 0:a.creator)==null?void 0:O.id)===o(s).user.id?(n(),w(ie,{key:1,onClick:e[4]||(e[4]=m=>o(_)._removeTable())})):P("",!0)]}),_:1})]),_:1})]),_:1}),k.value.length>0?(n(),w(Z,{key:0,"table-headers":Y.value},{default:t(()=>[(n(!0),M(z,null,ue(k.value,(a,O)=>(n(),w(ee,{key:`lobby-row-${a.id}`,onClick:m=>X(O,a),class:I(S.value===O?"bg-gray-700":"")},{default:t(()=>[l(h,null,{default:t(()=>[y(C(a.name),1)]),_:2},1024),l(h,null,{default:t(()=>{var m;return[y(C((m=a.game)==null?void 0:m.name),1)]}),_:2},1024),l(h,null,{default:t(()=>{var m;return[y(C((m=a.table_users)!=null&&m.length?a.table_users.length:0),1)]}),_:2},1024),l(h,null,{default:t(()=>[l(T,null,{default:t(()=>[a.private?(n(),M("div",$e,Ce)):(n(),M("div",Me,ke))]),_:2},1024)]),_:2},1024),l(h,null,{default:t(()=>{var m;return[y(C((m=a.creator)==null?void 0:m.username),1)]}),_:2},1024),l(h,{class:I([[a.status===o(j).WAITING?"text-blue-500":"",a.status===o(j).PLAYING?"text-primary":"",a.status===o(j).PAUSE?"text-yellow-500":""],"capitalize"])},{default:t(()=>[y(C(a.status),1)]),_:2},1032,["class"])]),_:2},1032,["onClick","class"]))),128))]),_:1},8,["table-headers"])):P("",!0)]),_:1})):(n(),w(D,{key:1},{default:t(()=>[l(T,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:t(()=>[y(" The game is supported on desktop computers ")]),_:1})]),_:1})),o(s).user.role!==o(A).guest?(n(),w(ye,{key:2,"is-modal-open":V.value,onCloseModal:e[5]||(e[5]=()=>V.value=!1)},null,8,["is-modal-open"])):P("",!0),l(ge,{"is-modal-open":i.value,username:o(s).user.username?o(s).user.username:"",onCloseModal:e[6]||(e[6]=a=>i.value=!1),onRegisterGuest:e[7]||(e[7]=a=>Q(a))},null,8,["is-modal-open","username"]),l(xe,{"is-modal-open":c.value,onCloseModal:e[8]||(e[8]=a=>c.value=!1),onSetPasswordTable:e[9]||(e[9]=a=>K(a))},null,8,["is-modal-open"])],64))}});export{qe as default};
