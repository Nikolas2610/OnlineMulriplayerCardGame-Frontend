import{_ as ee,D as te,a as T}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.0996cefb.js";import{_ as se}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as u,c as O,M as ae,d as U,L as b,l as t,m as c,j as a,r as p,v as W,k as o,i as n,K as le,a as re,u as oe,p as ne,q as ue,C as M,D as k,H as z,I as ie,G as H,R as I}from"./index.14bb9b25.js";import{_ as x,a as R}from"./CheckBoxField.vue_vue_type_script_setup_true_lang.7f0ddb16.js";import{_ as N}from"./InputField.vue_vue_type_script_setup_true_lang.3f8666b4.js";import{_ as q,R as de,a as me}from"./RemoveButton.4aeec85e.js";import{M as V,u as pe}from"./Modal.cb2be4ab.js";import{_ as ce}from"./TableForm.vue_vue_type_script_setup_true_lang.582d59ab.js";import{u as ve}from"./TableStore.4c73e105.js";import{u as fe,T as j}from"./PlayerStore.078c6055.js";import{b as S,s as be}from"./helpers.df839561.js";import{u as E,r as F}from"./index.esm.099a0bc5.js";import{M as _e}from"./MyTitle.c7a8da49.js";import"./PreLoader.971cfd0a.js";import"./axiosUser.1214f98e.js";const we={},ge={class:"container 2xl:w-4/6 px-4 py-4"};function ye(h,$){return u(),O("div",ge,[ae(h.$slots,"default")])}const D=se(we,[["render",ye]]),xe=U({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup(h,{emit:$}){return ve().fetchGames(),(_,g)=>(u(),b(V,{modalOpen:h.isModalOpen,onCloseModal:g[0]||(g[0]=m=>_.$emit("closeModal"))},{modal_header:t(()=>[c(" Create Table ")]),body:t(()=>[a(ce)]),_:1},8,["modalOpen"]))}}),he=U({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup(h,{emit:$}){const w=h,_=p({username:""});w.username&&(_.value.username=w.username);const g=W(()=>({username:{required:F}})),m=E(g,_),y=()=>{m.value.$validate(),m.value.$error||$("registerGuest",_.value.username)};return(i,l)=>(u(),b(V,{modalOpen:h.isModalOpen,onCloseModal:l[3]||(l[3]=v=>i.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[c(" Set Nickname ")]),body:t(()=>[a(x,null,{default:t(()=>[a(N,{title:"Nickname",input:_.value.username,onChange:l[0]||(l[0]=v=>_.value.username=v),errors:o(m).username.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[n("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:l[1]||(l[1]=v=>i.$emit("closeModal"))}," Close "),n("button",{onClick:l[2]||(l[2]=v=>y()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),Me=U({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup(h,{emit:$}){const w=p({password:""}),_=W(()=>({password:{required:F}})),g=E(_,w),m=()=>{g.value.$validate(),g.value.$error||$("setPasswordTable",w.value.password)};return(y,i)=>(u(),b(V,{modalOpen:h.isModalOpen,onCloseModal:i[3]||(i[3]=l=>y.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[c(" Password Table ")]),body:t(()=>[a(x,null,{default:t(()=>[a(N,{title:"Table Password",input:w.value.password,onChange:i[0]||(i[0]=l=>w.value.password=l),errors:o(g).password.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[n("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:i[1]||(i[1]=l=>y.$emit("closeModal"))}," Close "),n("button",{onClick:i[2]||(i[2]=l=>m()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),$e={class:"text-primary font-bold"},Ce=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-primary h-8 w-8",viewBox:"0 0 16 16"},[n("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),ke={class:"text-primary"},Te=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-[#cc6514] h-8 w-8",viewBox:"0 0 16 16"},[n("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Se={class:"text-[#cc6514]"},Oe={key:0},Pe=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[n("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),Ze=[Pe],Ge={key:1},Ue=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[n("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),Ae=[Ue],Ke=U({__name:"LobbyRoom",setup(h){const{width:$,height:w}=pe(),_=p(parseInt("600")),g=p(parseInt("1000")),m=p(!1),y=p(!1),i=le(),l=re(),v=p([]),P=p([]),J=oe(),d=fe(),A=p(""),B=p(!1),Z=p({countInRoomUsers:0,countOnlineUsers:0});ne(()=>{l.user.id||(m.value=!0),S.emit("findAllOnlineTable",{},r=>{v.value=P.value=r.tables,Z.value=r.countUsers}),S.on("getLastGame",r=>{d.leaverPlayer.table=d.table=r}),S.on("getUsersOnline",r=>{Z.value=r}),S.on("addNewTable",r=>{r.table_users=[],v.value.unshift(r)}),S.on("removeOldTable",r=>{v.value=P.value=v.value.filter(e=>e.id!==r)}),S.on("getTableUsers",r=>{var s;const e=v.value.map(C=>C.id).indexOf(r.id);e!==-1&&(v.value[e].table_users=(s=r.table_users)!=null?s:null)})});const L=()=>{if(d.table){if(!l.user.id){m.value=!0;return}d.table.private?y.value=!0:i.push({name:"room",params:{id:d.table.public_url}})}},K=async r=>{await d._validateTablePassword(r).then(e=>{e.status===200?d.table&&(y.value=!1,i.push({name:"room",params:{id:d.table.public_url}})):(y.value=!1,J.error("Wrong Password"))})},Y=p(["Table","Game","Players","Private","creator","status"]),G=p(-1),Q=r=>{l.registerGuest(r).then(()=>{m.value=!1,be(l.user.id)})},X=(r,e)=>{G.value===r?(G.value=-1,d.table=null):(G.value=r,d.table=e)};return ue(()=>A.value,r=>{P.value=v.value.filter(e=>e.name.toLocaleLowerCase().includes(r.toLocaleLowerCase()))}),(r,e)=>(u(),O(z,null,[o($)>g.value&&o(w)>_.value?(u(),b(D,{key:0},{default:t(()=>[a(x,{justify:"between",items:"end",class:"mb-8"},{default:t(()=>[a(_e,null,{default:t(()=>[c("Lobby")]),_:1}),o(l).user.email===null?(u(),O("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:e[0]||(e[0]=s=>m.value=!0)},M(o(l).user.username?"Change Nickname":"Add Nickname"),1)):k("",!0)]),_:1}),o(d).leaverPlayer.table?(u(),b(x,{key:0,justify:"between",items:"center",class:"p-4 bg-dark text-white rounded-xl mb-6 text-lg"},{default:t(()=>[n("div",null,[c(" Previous game: "),n("span",$e,M(o(d).leaverPlayer.table.name),1)]),n("div",null,[a(R,{title:"Resume Game",onClick:e[1]||(e[1]=s=>L())})])]),_:1})):k("",!0),Z.value?(u(),b(x,{key:1,justify:"center",class:"mt-6 p-4 text-xl",gap:8},{default:t(()=>[a(x,{items:"center",gap:2},{default:t(()=>[Ce,n("div",null,[c(" Users Online: "),n("span",ke,M(Z.value.countOnlineUsers),1)])]),_:1}),a(x,{items:"center",gap:2},{default:t(()=>[Te,n("div",null,[c(" Users in game: "),n("span",Se,M(Z.value.countInRoomUsers),1)])]),_:1})]),_:1})):k("",!0),a(me,{all:2,class:"mt-3 px-2"},{default:t(()=>[a(q,{all:1},{default:t(()=>[a(N,{input:A.value,placeholder:"Search a Table..",onChange:e[2]||(e[2]=s=>A.value=s)},null,8,["input","placeholder"])]),_:1}),a(q,{all:1},{default:t(()=>[a(x,{justify:"center",gap:2},{default:t(()=>{var s,C;return[o(l).user.role!==o(I).guest?(u(),b(R,{key:0,title:"Create Table",onClick:e[3]||(e[3]=f=>B.value=!0)})):k("",!0),a(R,{title:"Join Table",disable:G.value===-1,onClick:e[4]||(e[4]=f=>L())},null,8,["disable"]),((C=(s=o(d).table)==null?void 0:s.creator)==null?void 0:C.id)===o(l).user.id?(u(),b(de,{key:1,onClick:e[5]||(e[5]=f=>o(d)._removeTable())})):k("",!0)]}),_:1})]),_:1})]),_:1}),P.value.length>0?(u(),b(ee,{key:2,"table-headers":Y.value},{default:t(()=>[(u(!0),O(z,null,ie(P.value,(s,C)=>(u(),b(te,{key:`lobby-row-${s.id}`,onClick:f=>X(C,s),class:H(G.value===C?"bg-gray-700":"")},{default:t(()=>[a(T,null,{default:t(()=>[c(M(s.name),1)]),_:2},1024),a(T,null,{default:t(()=>{var f;return[c(M((f=s.game)==null?void 0:f.name),1)]}),_:2},1024),a(T,null,{default:t(()=>{var f;return[c(M((f=s.table_users)!=null&&f.length?s.table_users.length:0),1)]}),_:2},1024),a(T,null,{default:t(()=>[a(x,null,{default:t(()=>[s.private?(u(),O("div",Oe,Ze)):(u(),O("div",Ge,Ae))]),_:2},1024)]),_:2},1024),a(T,null,{default:t(()=>{var f;return[c(M((f=s.creator)==null?void 0:f.username),1)]}),_:2},1024),a(T,{class:H([[s.status===o(j).WAITING?"text-blue-500":"",s.status===o(j).PLAYING?"text-primary":"",s.status===o(j).PAUSE?"text-yellow-500":""],"capitalize"])},{default:t(()=>[c(M(s.status),1)]),_:2},1032,["class"])]),_:2},1032,["onClick","class"]))),128))]),_:1},8,["table-headers"])):k("",!0)]),_:1})):(u(),b(D,{key:1},{default:t(()=>[a(x,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:t(()=>[c(" The game is supported on desktop computers ")]),_:1})]),_:1})),o(l).user.role!==o(I).guest?(u(),b(xe,{key:2,"is-modal-open":B.value,onCloseModal:e[6]||(e[6]=()=>B.value=!1)},null,8,["is-modal-open"])):k("",!0),a(he,{"is-modal-open":m.value,username:o(l).user.username?o(l).user.username:"",onCloseModal:e[7]||(e[7]=s=>m.value=!1),onRegisterGuest:e[8]||(e[8]=s=>Q(s))},null,8,["is-modal-open","username"]),a(Me,{"is-modal-open":y.value,onCloseModal:e[9]||(e[9]=s=>y.value=!1),onSetPasswordTable:e[10]||(e[10]=s=>K(s))},null,8,["is-modal-open"])],64))}});export{Ke as default};
