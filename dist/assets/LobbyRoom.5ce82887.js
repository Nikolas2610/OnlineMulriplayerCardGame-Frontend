import{_ as ve,D as fe,a as I}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.3a7d2e61.js";import{_ as H}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as n,c as A,M as _e,d as G,L as c,l as e,m as u,j as l,r as _,v as ee,k as o,N as se,h as te,i as m,K as ge,a as we,u as ye,p as be,q as he,C,D as T,H as K,I as $e,G as E,R as Y}from"./index.ecc95ab6.js";import{_ as J}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.e79c01aa.js";import{_ as M}from"./Flex.vue_vue_type_script_setup_true_lang.51f0fb1e.js";import{_ as D}from"./InputField.vue_vue_type_script_setup_true_lang.7f869f00.js";import{_ as Q,a as xe}from"./GridColItem.vue_vue_type_script_setup_true_lang.9c78d1be.js";import{M as F,a as ae,u as Me}from"./ModalSecondaryButton.81eaa457.js";import{_ as Ce,S as ke}from"./TableForm.vue_vue_type_script_setup_true_lang.9f5f3662.js";import{u as le}from"./TableStore.52e72fe7.js";import{u as Te,T as S}from"./PlayerStore.408a3f4f.js";import{b as R,s as Se}from"./helpers.39175911.js";import{R as Pe}from"./RemoveButton.9e5d3ec5.js";import{u as oe,r as re}from"./index.esm.a9fe688c.js";import{_ as ne}from"./ModalPrimaryButton.vue_vue_type_script_setup_true_lang.587daab3.js";import{M as Oe}from"./MyTitle.60c32050.js";import{_ as Ae}from"./Alert.vue_vue_type_script_setup_true_lang.89053a40.js";import"./SelectField.vue_vue_type_script_setup_true_lang.51461717.js";import"./CheckBoxField.vue_vue_type_script_setup_true_lang.e3be5df0.js";import"./PreLoader.0177c0bf.js";import"./axiosUser.bb857d56.js";const Le={},Ie={class:"container 2xl:w-4/6 px-4 py-4"};function Re($,k){return n(),A("div",Ie,[_e($.$slots,"default")])}const X=H(Le,[["render",Re]]),Ne=G({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup($,{emit:k}){return le().fetchGames(),(w,y)=>(n(),c(F,{modalOpen:$.isModalOpen,onCloseModal:y[1]||(y[1]=v=>w.$emit("closeModal"))},{modal_header:e(()=>[u(" Create Table ")]),body:e(()=>[l(Ce,{onCloseModal:y[0]||(y[0]=v=>w.$emit("closeModal"))})]),_:1},8,["modalOpen"]))}}),Be=G({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup($,{emit:k}){const g=$,w=_({username:""});g.username&&(w.value.username=g.username);const y=ee(()=>({username:{required:re}})),v=oe(y,w),x=()=>{v.value.$validate(),v.value.$error||k("registerGuest",w.value.username)};return(p,d)=>(n(),c(F,{modalOpen:$.isModalOpen,onCloseModal:d[4]||(d[4]=i=>p.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:e(()=>[u(" Set Nickname ")]),body:e(()=>[l(M,null,{default:e(()=>[l(D,{title:"Nickname",input:w.value.username,onChange:d[0]||(d[0]=i=>w.value.username=i),errors:o(v).username.$errors,onKeyup:d[1]||(d[1]=se(i=>x(),["enter"]))},null,8,["input","errors"])]),_:1})]),modal_footer:e(()=>[l(ae,{onClick:d[2]||(d[2]=i=>p.$emit("closeModal"))},{default:e(()=>[u(" Close ")]),_:1}),l(ne,{onClick:d[3]||(d[3]=i=>x())},{default:e(()=>[u(" Submit ")]),_:1})]),_:1},8,["modalOpen"]))}}),Ue=G({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup($,{emit:k}){const g=_({password:""}),w=ee(()=>({password:{required:re}})),y=oe(w,g),v=()=>{y.value.$validate(),y.value.$error||k("setPasswordTable",g.value.password)};return(x,p)=>(n(),c(F,{modalOpen:$.isModalOpen,onCloseModal:p[4]||(p[4]=d=>x.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:e(()=>[u(" Password Table ")]),body:e(()=>[l(M,null,{default:e(()=>[l(D,{title:"Table Password",input:g.value.password,onChange:p[0]||(p[0]=d=>g.value.password=d),errors:o(y).password.$errors,onKeyup:p[1]||(p[1]=se(d=>v(),["enter"]))},null,8,["input","errors"])]),_:1})]),modal_footer:e(()=>[l(ae,{onClick:p[2]||(p[2]=d=>x.$emit("closeModal"))},{default:e(()=>[u("Close")]),_:1}),l(ne,{onClick:p[3]||(p[3]=d=>v())},{default:e(()=>[u("Submit")]),_:1})]),_:1},8,["modalOpen"]))}}),Ze={},Ve={class:"fixed bottom-0 left-0 w-full bg-primary py-3 px-8 text-white"};function Ee($,k){const g=te("RouterLink");return n(),A("div",Ve,[u(" ***Note: If you would like to create your own game, we kindly ask you to create a "),l(g,{to:{name:"register"},class:"underline"},{default:e(()=>[u("real account")]),_:1}),u(". This will give you full access to all the features and tools you need to bring your game to life. real account. ")])}const Ge=H(Ze,[["render",Ee]]),je={},ze={type:"button",class:"rounded-md border border-transparent bg-primary text-white px-8 font-medium hover:bg-secondary md:py-1 md:px-3 transition duration-150 text-2xl flex justify-center items-center"},He=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"#FFF",class:"w-7 h-6",viewBox:"0 0 16 16"},[m("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),m("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})],-1),De=[He];function Fe($,k){return n(),A("button",ze,De)}const We=H(je,[["render",Fe]]),qe={class:"text-primary font-bold"},Ke=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-primary h-8 w-8",viewBox:"0 0 16 16"},[m("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Ye={class:"text-primary"},Je=m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-[#cc6514] h-8 w-8",viewBox:"0 0 16 16"},[m("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Qe={class:"text-[#cc6514]"},Xe={key:0},es=m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[m("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),ss=[es],ts={key:1},as=m("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[m("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),ls=[as],ks=G({__name:"LobbyRoom",setup($){const{width:k,height:g}=Me(),w=_(parseInt("600")),y=_(parseInt("1000")),v=_(!1),x=_(!1),p=_(0),d=ge(),i=we(),b=_([]),N=_([]),j=ye(),r=Te(),ue=le(),Z=_(""),z=_(!1),B=_({countInRoomUsers:0,countOnlineUsers:0});be(()=>{i.user.id||(v.value=!0),R.emit("getAllOnlineTable",{},a=>{var t;b.value=N.value=(t=a.tables)!=null?t:[],B.value=a.countUsers}),R.on("getLastGame",a=>{r.leaverPlayer.table=r.table={...a}}),R.on("getUsersOnline",a=>{B.value=a}),R.on("getOnlineTable",a=>{a.table_users=[],b.value.unshift(a)}),R.on("getRemoveTable",a=>{b.value=N.value=b.value.filter(t=>t.id!==a)}),R.on("getTableUsers",a=>{var h;const t=b.value.map(s=>s.id).indexOf(a.id);t!==-1&&(b.value[t].table_users=(h=a.table_users)!=null?h:null)}),R.on("getUpdateTable",a=>{const t=b.value.map(h=>h.id).indexOf(a==null?void 0:a.id);t===-1?b.value.push(a):a.status===S.FINISH?b.value.splice(t,1):b.value[t]=a,N.value=b.value.filter(h=>h.name.toLocaleLowerCase().includes(Z.value.toLocaleLowerCase()))})});const W=a=>{var t,h,s,L,U,P;if(r.table=a,!!r.table){if(!i.user.id){v.value=!0;return}if(r.table.private){x.value=!0;return}if(!(!((t=r.table.game)!=null&&t.max_players)||!((h=r.table)!=null&&h.table_users))){if(((L=(s=r.table)==null?void 0:s.table_users)==null?void 0:L.length)<((U=r.table.game)==null?void 0:U.max_players)){r.leaverPlayer.table=null,d.push({name:"room",params:{id:r.table.public_url}});return}if(((P=r.leaverPlayer)==null?void 0:P.table)&&(a==null?void 0:a.table_users)&&(a==null?void 0:a.table_users.find(O=>O.user.id===i.user.id))){r.leaverPlayer.table=null,d.push({name:"room",params:{id:r.table.public_url}});return}j.error("The table is full")}}},ie=async a=>{await r._validateTablePassword(a).then(t=>{t.status===200?r.table&&(x.value=!1,d.push({name:"room",params:{id:r.table.public_url}})):(x.value=!1,j.error("Wrong Password"))})},de=()=>{ue.games.length===0?j.warning("You have to create a game first"):z.value=!0},me=_(["Table","Game","Players","Private","creator","status"]),V=_(-1),pe=a=>{i.registerGuest(a).then(()=>{v.value=!1,Se(i.user.id)})},ce=(a,t)=>{V.value===a?(V.value=-1,r.table=null):(V.value=a,r.table={...t})};return he(()=>Z.value,a=>{N.value=b.value.filter(t=>t.name.toLocaleLowerCase().includes(a.toLocaleLowerCase()))}),(a,t)=>{const h=te("VTooltip");return n(),A(K,null,[o(k)>y.value&&o(g)>w.value?(n(),c(X,{key:0},{default:e(()=>[l(M,{justify:"between",items:"end",class:"mb-4"},{default:e(()=>[l(Oe,null,{default:e(()=>[u("Lobby")]),_:1}),o(i).user.email===null?(n(),A("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:t[0]||(t[0]=s=>v.value=!0)},C(o(i).user.username?"Change Nickname":"Add Nickname"),1)):T("",!0)]),_:1}),o(r).leaverPlayer.table?(n(),c(M,{key:0,justify:"between",items:"center",class:"p-4 bg-dark text-white rounded-xl mb-6 text-lg"},{default:e(()=>[m("div",null,[u(" Previous game: "),m("span",qe,C(o(r).leaverPlayer.table.name),1)]),m("div",null,[o(r).leaverPlayer&&o(r).leaverPlayer.table?(n(),c(J,{key:0,title:"Resume Game",onClick:t[1]||(t[1]=s=>W(o(r).leaverPlayer.table))})):T("",!0)])]),_:1})):T("",!0),B.value?(n(),c(M,{key:1,justify:"center",class:"mt-3 p-4 text-xl",gap:8},{default:e(()=>[l(M,{items:"center",gap:2},{default:e(()=>[Ke,m("div",null,[u(" Users Online: "),m("span",Ye,C(B.value.countOnlineUsers),1)])]),_:1}),l(M,{items:"center",gap:2},{default:e(()=>[Je,m("div",null,[u(" Users in game: "),m("span",Qe,C(B.value.countInRoomUsers),1)])]),_:1})]),_:1})):T("",!0),l(xe,{all:2,class:"my-3 px-2"},{default:e(()=>[l(Q,{all:1},{default:e(()=>[l(D,{input:Z.value,placeholder:"Search a Table..",onChange:t[2]||(t[2]=s=>Z.value=s)},null,8,["input","placeholder"])]),_:1}),l(Q,{all:1},{default:e(()=>[l(M,{justify:"end",gap:2},{default:e(()=>[o(i).user.role!==o(Y).guest?(n(),c(J,{key:0,title:"Create Table",onClick:t[3]||(t[3]=s=>de())})):T("",!0)]),_:1})]),_:1})]),_:1}),N.value.length>0?(n(),c(ve,{key:2,"table-headers":me.value,class:"max-h-[490px] overflow-x-auto",actions:!0},{default:e(()=>[(n(!0),A(K,null,$e(N.value,(s,L)=>{var U;return n(),c(fe,{key:`lobby-row-${s.id}`,class:E(["cursor-pointer transition duration-1000",[V.value===L?"bg-gray-700":"",((U=s.creator)==null?void 0:U.id)===o(i).user.id?"bg-[#222]":""]]),onClick:P=>ce(L,s),onMouseover:P=>p.value=L,onMouseleave:t[4]||(t[4]=P=>p.value=-1)},{default:e(()=>{var P;return[l(I,{class:"w-2/12"},{default:e(()=>[u(C(s.name),1)]),_:2},1024),l(I,{class:"w-2/12"},{default:e(()=>{var f;return[u(C((f=s.game)==null?void 0:f.name),1)]}),_:2},1024),l(I,{class:"w-1/12"},{default:e(()=>{var f,O,q;return[m("span",{class:E(((f=s.table_users)==null?void 0:f.length)&&s.table_users.length>0?"text-primary":"")},C((O=s.table_users)!=null&&O.length?s.table_users.length:0),3),u(" / "+C((q=s.game)==null?void 0:q.max_players),1)]}),_:2},1024),l(I,{class:"w-1/12"},{default:e(()=>[l(M,null,{default:e(()=>[s.private?(n(),A("div",Xe,ss)):(n(),A("div",ts,ls))]),_:2},1024)]),_:2},1024),l(I,{class:E(["w-2/12",((P=s.creator)==null?void 0:P.id)===o(i).user.id?"text-primary":""])},{default:e(()=>{var f;return[u(C((f=s.creator)==null?void 0:f.username),1)]}),_:2},1032,["class"]),l(I,{class:E(["w-2/12 capitalize",[s.status===o(S).WAITING?"text-blue-500":"",s.status===o(S).PLAYING?"text-primary":"",s.status===o(S).PLAYER_DISCONNECTED||s.status===o(S).PLAYER_LEAVE?"text-red-500":"",s.status===o(S).PAUSE||s.status===o(S).GAME_MASTER_EDIT?"text-orange-500":""]])},{default:e(()=>{var f;return[u(C(((f=o(ke).find(O=>O.id===s.status))==null?void 0:f.name)||"Unknown"),1)]}),_:2},1032,["class"]),l(I,{class:"w-2/2"},{default:e(()=>[l(M,{gap:2,class:"w-full",justify:"center"},{default:e(()=>{var f;return[s.status===o(S).WAITING?(n(),c(h,{key:0},{popper:e(()=>[u(" Join Table ")]),default:e(()=>[l(We,{onClick:O=>W(s)},null,8,["onClick"])]),_:2},1024)):T("",!0),p.value===L&&((f=s.creator)==null?void 0:f.id)===o(i).user.id&&s.status===o(S).WAITING?(n(),c(h,{key:1},{popper:e(()=>[u(" Remove Table ")]),default:e(()=>[l(Pe,{onClick:O=>o(r)._removeTable(s==null?void 0:s.id)},null,8,["onClick"])]),_:2},1024)):T("",!0)]}),_:2},1024)]),_:2},1024)]}),_:2},1032,["onClick","class","onMouseover"])}),128))]),_:1},8,["table-headers"])):(n(),c(Ae,{key:3,class:"mt-10"},{default:e(()=>[u(" No available tables to join. Create a table to start a game! ")]),_:1}))]),_:1})):(n(),c(X,{key:1},{default:e(()=>[l(M,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:e(()=>[u(" The game is supported on desktop computers ")]),_:1})]),_:1})),o(i).user.role!==o(Y).guest?(n(),c(Ne,{key:2,"is-modal-open":z.value,onCloseModal:t[5]||(t[5]=()=>z.value=!1)},null,8,["is-modal-open"])):T("",!0),l(Be,{"is-modal-open":v.value,username:o(i).user.username?o(i).user.username:"",onCloseModal:t[6]||(t[6]=s=>v.value=!1),onRegisterGuest:t[7]||(t[7]=s=>pe(s))},null,8,["is-modal-open","username"]),l(Ue,{"is-modal-open":x.value,onCloseModal:t[8]||(t[8]=s=>x.value=!1),onSetPasswordTable:t[9]||(t[9]=s=>ie(s))},null,8,["is-modal-open"]),o(i).isGuest?(n(),c(Ge,{key:3})):T("",!0)],64)}}});export{ks as default};
