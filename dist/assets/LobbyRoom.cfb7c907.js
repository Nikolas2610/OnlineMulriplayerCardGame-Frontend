import{_ as le,D as re,a as T}from"./DarkTableCell.vue_vue_type_script_setup_true_lang.0aa17a6a.js";import{_ as oe,o as d,c as O,M as ne,d as U,L as g,l as a,m as v,j as l,r as f,v as Y,k as o,i as n,K as ue,a as ie,u as de,p as me,q as pe,C as h,D as k,H,I as fe,G as E,R as D}from"./index.6223a65c.js";import{_ as V}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.cfa643c9.js";import{_ as M}from"./CheckBoxField.vue_vue_type_script_setup_true_lang.c7674399.js";import{_ as j}from"./InputField.vue_vue_type_script_setup_true_lang.f83c3aaa.js";import{_ as q,R as ve,a as ce}from"./RemoveButton.60073e8f.js";import{M as I,u as be}from"./Modal.91a465e1.js";import{_ as _e,S as ge}from"./TableForm.vue_vue_type_script_setup_true_lang.faadc713.js";import{u as F}from"./TableStore.ed7c5809.js";import{u as we,T as R}from"./PlayerStore.3cf15375.js";import{b as S,s as ye}from"./helpers.8cb9edf9.js";import{u as J,r as K}from"./index.esm.db19b367.js";import{M as xe}from"./MyTitle.afc7dae6.js";import"./PreLoader.e3fb3ec5.js";import"./axiosUser.42d6f6e2.js";const he={},Me={class:"container 2xl:w-4/6 px-4 py-4"};function $e($,C){return d(),O("div",Me,[ne($.$slots,"default")])}const W=oe(he,[["render",$e]]),Ce=U({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup($,{emit:C}){return F().fetchGames(),(c,b)=>(d(),g(I,{modalOpen:$.isModalOpen,onCloseModal:b[1]||(b[1]=m=>c.$emit("closeModal"))},{modal_header:a(()=>[v(" Create Table ")]),body:a(()=>[l(_e,{onCloseModal:b[0]||(b[0]=m=>c.$emit("closeModal"))})]),_:1},8,["modalOpen"]))}}),ke=U({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup($,{emit:C}){const w=$,c=f({username:""});w.username&&(c.value.username=w.username);const b=Y(()=>({username:{required:K}})),m=J(b,c),y=()=>{m.value.$validate(),m.value.$error||C("registerGuest",c.value.username)};return(p,r)=>(d(),g(I,{modalOpen:$.isModalOpen,onCloseModal:r[3]||(r[3]=_=>p.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:a(()=>[v(" Set Nickname ")]),body:a(()=>[l(M,null,{default:a(()=>[l(j,{title:"Nickname",input:c.value.username,onChange:r[0]||(r[0]=_=>c.value.username=_),errors:o(m).username.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:a(()=>[n("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:r[1]||(r[1]=_=>p.$emit("closeModal"))}," Close "),n("button",{onClick:r[2]||(r[2]=_=>y()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),Te=U({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup($,{emit:C}){const w=f({password:""}),c=Y(()=>({password:{required:K}})),b=J(c,w),m=()=>{b.value.$validate(),b.value.$error||C("setPasswordTable",w.value.password)};return(y,p)=>(d(),g(I,{modalOpen:$.isModalOpen,onCloseModal:p[3]||(p[3]=r=>y.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:a(()=>[v(" Password Table ")]),body:a(()=>[l(M,null,{default:a(()=>[l(j,{title:"Table Password",input:w.value.password,onChange:p[0]||(p[0]=r=>w.value.password=r),errors:o(b).password.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:a(()=>[n("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:p[1]||(p[1]=r=>y.$emit("closeModal"))}," Close "),n("button",{onClick:p[2]||(p[2]=r=>m()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),Se={class:"text-primary font-bold"},Oe=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-primary h-8 w-8",viewBox:"0 0 16 16"},[n("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Pe={class:"text-primary"},Ze=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-people text-[#cc6514] h-8 w-8",viewBox:"0 0 16 16"},[n("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"})],-1),Ae={class:"text-[#cc6514]"},Ge={key:0},Re=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[n("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),Ue=[Re],Be={key:1},Le=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[n("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),Ne=[Le],et=U({__name:"LobbyRoom",setup($){const{width:C,height:w}=be(),c=f(parseInt("600")),b=f(parseInt("1000")),m=f(!1),y=f(!1),p=ue(),r=ie(),_=f([]),P=f([]),B=de(),u=we(),Q=F(),L=f(""),N=f(!1),Z=f({countInRoomUsers:0,countOnlineUsers:0});me(()=>{r.user.id||(m.value=!0),S.emit("findAllOnlineTable",{},s=>{_.value=P.value=s.tables,Z.value=s.countUsers}),S.on("getLastGame",s=>{u.leaverPlayer.table=u.table=s}),S.on("getUsersOnline",s=>{Z.value=s}),S.on("addNewTable",s=>{s.table_users=[],_.value.unshift(s)}),S.on("removeOldTable",s=>{_.value=P.value=_.value.filter(e=>e.id!==s)}),S.on("getTableUsers",s=>{var t;const e=_.value.map(x=>x.id).indexOf(s.id);e!==-1&&(_.value[e].table_users=(t=s.table_users)!=null?t:null)})});const z=()=>{var s,e,t,x,i;if(u.table){if(!r.user.id){m.value=!0;return}u.table.private?y.value=!0:((s=u.table.game)==null?void 0:s.max_players)&&((e=u.table)==null?void 0:e.table_users)&&(((x=(t=u.table)==null?void 0:t.table_users)==null?void 0:x.length)<((i=u.table.game)==null?void 0:i.max_players)?p.push({name:"room",params:{id:u.table.public_url}}):B.error("The table is full"))}},X=async s=>{await u._validateTablePassword(s).then(e=>{e.status===200?u.table&&(y.value=!1,p.push({name:"room",params:{id:u.table.public_url}})):(y.value=!1,B.error("Wrong Password"))})},ee=()=>{Q.games.length===0?B.warning("You have to create a game first"):N.value=!0},te=f(["Table","Game","Players","Private","creator","status"]),A=f(-1),ae=s=>{r.registerGuest(s).then(()=>{m.value=!1,ye(r.user.id)})},se=(s,e)=>{A.value===s?(A.value=-1,u.table=null):(A.value=s,u.table=e)};return pe(()=>L.value,s=>{P.value=_.value.filter(e=>e.name.toLocaleLowerCase().includes(s.toLocaleLowerCase()))}),(s,e)=>(d(),O(H,null,[o(C)>b.value&&o(w)>c.value?(d(),g(W,{key:0},{default:a(()=>[l(M,{justify:"between",items:"end",class:"mb-4"},{default:a(()=>[l(xe,null,{default:a(()=>[v("Lobby")]),_:1}),o(r).user.email===null?(d(),O("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:e[0]||(e[0]=t=>m.value=!0)},h(o(r).user.username?"Change Nickname":"Add Nickname"),1)):k("",!0)]),_:1}),o(u).leaverPlayer.table?(d(),g(M,{key:0,justify:"between",items:"center",class:"p-4 bg-dark text-white rounded-xl mb-6 text-lg"},{default:a(()=>[n("div",null,[v(" Previous game: "),n("span",Se,h(o(u).leaverPlayer.table.name),1)]),n("div",null,[l(V,{title:"Resume Game",onClick:e[1]||(e[1]=t=>z())})])]),_:1})):k("",!0),Z.value?(d(),g(M,{key:1,justify:"center",class:"mt-3 p-4 text-xl",gap:8},{default:a(()=>[l(M,{items:"center",gap:2},{default:a(()=>[Oe,n("div",null,[v(" Users Online: "),n("span",Pe,h(Z.value.countOnlineUsers),1)])]),_:1}),l(M,{items:"center",gap:2},{default:a(()=>[Ze,n("div",null,[v(" Users in game: "),n("span",Ae,h(Z.value.countInRoomUsers),1)])]),_:1})]),_:1})):k("",!0),l(ce,{all:2,class:"my-3 px-2"},{default:a(()=>[l(q,{all:1},{default:a(()=>[l(j,{input:L.value,placeholder:"Search a Table..",onChange:e[2]||(e[2]=t=>L.value=t)},null,8,["input","placeholder"])]),_:1}),l(q,{all:1},{default:a(()=>[l(M,{justify:"end",gap:2},{default:a(()=>{var t,x;return[((x=(t=o(u).table)==null?void 0:t.creator)==null?void 0:x.id)===o(r).user.id?(d(),g(ve,{key:0,onClick:e[3]||(e[3]=i=>o(u)._removeTable())})):k("",!0),o(r).user.role!==o(D).guest?(d(),g(V,{key:1,title:"Create Table",onClick:e[4]||(e[4]=i=>ee())})):k("",!0),l(V,{title:"Join Table",disable:A.value===-1,onClick:e[5]||(e[5]=i=>z())},null,8,["disable"])]}),_:1})]),_:1})]),_:1}),P.value.length>0?(d(),g(le,{key:2,"table-headers":te.value,class:"max-h-[490px] overflow-x-auto"},{default:a(()=>[(d(!0),O(H,null,fe(P.value,(t,x)=>(d(),g(re,{key:`lobby-row-${t.id}`,onClick:i=>se(x,t),class:E(A.value===x?"bg-gray-700":"")},{default:a(()=>[l(T,null,{default:a(()=>[v(h(t.name),1)]),_:2},1024),l(T,null,{default:a(()=>{var i;return[v(h((i=t.game)==null?void 0:i.name),1)]}),_:2},1024),l(T,null,{default:a(()=>{var i,G;return[v(h((i=t.table_users)!=null&&i.length?t.table_users.length:0)+" / "+h((G=t.game)==null?void 0:G.max_players),1)]}),_:2},1024),l(T,null,{default:a(()=>[l(M,null,{default:a(()=>[t.private?(d(),O("div",Ge,Ue)):(d(),O("div",Be,Ne))]),_:2},1024)]),_:2},1024),l(T,null,{default:a(()=>{var i;return[v(h((i=t.creator)==null?void 0:i.username),1)]}),_:2},1024),l(T,{class:E([[t.status===o(R).WAITING?"text-blue-500":"",t.status===o(R).PLAYING?"text-primary":"",t.status===o(R).PLAYER_DISCONNECTED||t.status===o(R).PLAYER_LEAVE?"text-red-500":""],"capitalize"])},{default:a(()=>{var i;return[v(h(((i=o(ge).find(G=>G.id===t.status))==null?void 0:i.name)||"Unknown"),1)]}),_:2},1032,["class"])]),_:2},1032,["onClick","class"]))),128))]),_:1},8,["table-headers"])):k("",!0)]),_:1})):(d(),g(W,{key:1},{default:a(()=>[l(M,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:a(()=>[v(" The game is supported on desktop computers ")]),_:1})]),_:1})),o(r).user.role!==o(D).guest?(d(),g(Ce,{key:2,"is-modal-open":N.value,onCloseModal:e[6]||(e[6]=()=>N.value=!1)},null,8,["is-modal-open"])):k("",!0),l(ke,{"is-modal-open":m.value,username:o(r).user.username?o(r).user.username:"",onCloseModal:e[7]||(e[7]=t=>m.value=!1),onRegisterGuest:e[8]||(e[8]=t=>ae(t))},null,8,["is-modal-open","username"]),l(Te,{"is-modal-open":y.value,onCloseModal:e[9]||(e[9]=t=>y.value=!1),onSetPasswordTable:e[10]||(e[10]=t=>X(t))},null,8,["is-modal-open"])],64))}});export{et as default};
