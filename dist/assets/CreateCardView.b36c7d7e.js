import{M as I}from"./MyTitle.1c0e8bae.js";import{_ as F}from"./CardForm.vue_vue_type_script_setup_true_lang.cd583d4e.js";import{a as k}from"./axiosUser.035fd5a5.js";import{d as P,u as T,r as _,o as c,c as y,j as a,l as t,m as p,i as h,G as R,L as C,D as b,H as V,I as B,k as G,C as M}from"./index.5392844b.js";import{_ as o}from"./Flex.vue_vue_type_script_setup_true_lang.53cd6fc7.js";import{_ as O}from"./InputField.vue_vue_type_script_setup_true_lang.e63313a2.js";import{_ as L}from"./CheckBoxField.vue_vue_type_script_setup_true_lang.a1d4b069.js";import{_ as u,a as x}from"./GridColItem.vue_vue_type_script_setup_true_lang.356639a5.js";import{R as N}from"./RemoveButton.10d279e7.js";import{_ as U}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.b0e63abf.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./helpers.2772eae0.js";var f=(g=>(g.PENDING="pending",g.ERROR="error",g))(f||{});const z={class:"container w-4/6 border rounded-lg shadow-xl lg:mt-4"},A={key:1,class:"py-8"},J={class:"max-h-[500px] overflow-y-auto"},H=["src"],re=P({__name:"CreateCardView",setup(g){const i=T(),j=_(-1),m=_(!1),r=_([]),v=_(!1),$=n=>{const s=n.target.files;for(let e=0;e<s.length;e++){const l=s[e];if(l.type==="image/png"||l.type==="image/jpeg"||l.type==="image/jpg")if(l.size<=2097152){const d={imageName:l.name,name:l.name,file:l,imageScreen:"",private:!1,status:f.PENDING},w=new FileReader;w.onload=()=>{d.imageScreen=w.result,r.value.push(d)},w.readAsDataURL(l)}else i.error("File size exceeds the maximum limit of 2MB.");else i.error("Invalid file type. Only PNG, JPEG, and JPG files are allowed.")}},D=n=>{r.value=r.value.filter((s,e)=>n!==e)},S=async()=>{v.value=!0;let n=[];for(const e of r.value){const l=new FormData;l.append("image",e.file,e.name),l.append("name",e.imageName),l.append("private",e.private.toString());try{(await k.post("card",l,{headers:{"Content-Type":"multipart/form-data"}})).status!==201&&(e.status=f.ERROR,n.push(e))}catch{i.error("Error uploading image"),e.status=f.ERROR,n.push(e)}}let s=r.value.length-n.length;s===r.value.length?i.success("All cards uploaded successfully!"):s>0?i.warning(`${s} of ${r.value.length} cards uploaded successfully. Some images failed to upload.`):i.error("No cards were uploaded. Please check your images and try again."),r.value=n,v.value=!1},E=async(n,s)=>{if(n.name.length<3){i.error("The card name must have at least 4 characters");return}if(!s.file){i.error("You have to choose an image to upload");return}const e=new FormData;e.append("image",s.file,s.name),e.append("name",n.name),e.append("private",n.private.toString());try{if((await k.post("card",e,{headers:{"Content-Type":"multipart/form-data"}})).status===201){i.success("Card saved successfully"),j.value=1,setTimeout(()=>{j.value=-1},1e3);return}i.error("Something went wrong. Please try again later")}catch(l){l.response.data.message==="Validation failed (expected type is .(png|jpeg|jpg|svg))"&&i.error("Valid types images are png, jpeg, and jpg")}};return(n,s)=>(c(),y("div",z,[a(I,null,{default:t(()=>[p("Create Card")]),_:1}),a(o,{justify:"center",items:"center",gap:4,class:"px-2"},{default:t(()=>[h("div",{class:R(["py-2 border-b-2 px-4 hover:border-secondary transition duration-300 cursor-pointer",m.value?"border-white":"border-primary"]),onClick:s[0]||(s[0]=e=>m.value=!1)}," Single Card",2),h("div",{class:R(["py-2 border-b-2 hover:border-secondary transition duration-300 cursor-pointer",m.value?"border-primary":"border-white"]),onClick:s[1]||(s[1]=e=>m.value=!0)}," Multiple Cards",2)]),_:1}),m.value?(c(),y("div",A,[a(o,{justify:"between",items:"center"},{default:t(()=>[h("input",{id:"imageFile",type:"file",class:"rounded-md border border-gray-300",multiple:"",accept:".png,.jpeg,.jpg",max:"2097152",onChange:$},null,32),a(o,{gap:4},{default:t(()=>[r.value.length>0?(c(),C(N,{key:0,onClick:s[2]||(s[2]=e=>r.value=[])})):b("",!0),a(U,{title:"Upload Cards",disable:r.value.length===0||v.value,onClick:s[3]||(s[3]=e=>S()),loading:v.value},null,8,["disable","loading"])]),_:1})]),_:1}),r.value.length>0?(c(),C(x,{key:0,all:12,gap:4,class:"py-4 border rounded mt-8"},{default:t(()=>[a(u,{all:3},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[p(" Card Name ")]),_:1})]),_:1}),a(u,{all:3},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[p(" Image ")]),_:1})]),_:1}),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[p(" Private ")]),_:1})]),_:1}),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[p(" Image Status ")]),_:1})]),_:1}),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[p(" Action ")]),_:1})]),_:1})]),_:1})):b("",!0),h("div",J,[(c(!0),y(V,null,B(r.value,(e,l)=>(c(),C(x,{all:12,gap:4,class:"py-1 border rounded",key:l},{default:t(()=>[a(u,{all:3},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[a(O,{input:e.imageName,onChange:d=>e.imageName=d},null,8,["input","onChange"])]),_:2},1024)]),_:2},1024),a(u,{all:3},{default:t(()=>[a(o,{class:"h-full",justify:"center",items:"center"},{default:t(()=>[e.imageScreen?(c(),y("img",{key:0,src:e.imageScreen,class:"w-28 h-28"},null,8,H)):b("",!0)]),_:2},1024)]),_:2},1024),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[a(L,{input:e.private,onChange:d=>e.private=d},null,8,["input","onChange"])]),_:2},1024)]),_:2},1024),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:R(["h-full",[e.status===G(f).ERROR?"text-red-500":"text-orange-500"]])},{default:t(()=>[p(M(e.status),1)]),_:2},1032,["class"])]),_:2},1024),a(u,{all:2},{default:t(()=>[a(o,{justify:"center",items:"center",class:"h-full"},{default:t(()=>[a(N,{onClick:d=>D(l)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])])):(c(),C(F,{key:0,onSendData:E,successResponse:j.value,cardData:void 0,imageFile:void 0},null,8,["successResponse"]))]))}});export{re as default};
