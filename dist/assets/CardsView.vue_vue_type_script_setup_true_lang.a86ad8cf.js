import{_ as B}from"./CardForm.vue_vue_type_script_setup_true_lang.22173c7e.js";import{M as D}from"./MyTitle.d8799585.js";import{a as g}from"./axiosUser.065c3de2.js";import{M as I}from"./Modal.08462354.js";import{d as O,a as P,a3 as j,e as o,u as G,b as L,o as n,c as r,h as e,i as v,w as u,k as w,G as b,H as M,B as f,j as U}from"./index.34df172d.js";import{l as H}from"./Function.3ea76856.js";const Y={class:"w-full overflow-x-auto px-4"},q={key:0},z={class:"mx-auto my-4"},J={class:"flex flex-col"},K={class:"overflow-x-auto shadow-md sm:rounded-lg"},Q={class:"inline-block min-w-full align-middle"},W={class:"overflow-hidden"},X={class:"min-w-full divide-y table-fixed divide-gray-700"},Z={class:"bg-gray-700"},ee=e("th",{scope:"col",class:"p-4"},[e("span",{class:"sr-only"},"Edit")],-1),te={class:"divide-y bg-dark divide-gray-700"},se={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},ae={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},oe={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},le=["src","alt"],ne={class:"py-4 px-6 text-sm font-medium whitespace-nowrap text-white"},re={class:"py-4 px-6 text-sm font-medium text-right whitespace-nowrap"},de=["onClick"],ie=["onClick"],ce={key:1},ue=e("div",null," Do you really want to delete this card? This process cannot be undone ",-1),ge=O({__name:"CardsView",setup(me){const S=P(),E=j(),m=o("user"),d=G(),i=o(!1),c=o([]),y=o(),p=o(null),C=o(),h=o(!1),$=o(-1),F=o(["No","NAME","IMAGE","PRIVATE"]);L(async()=>{E.meta.admin&&(m.value=S.$state.user.role),x()});const N=()=>{h.value=!1},k=()=>{i.value=!1},x=async()=>{try{const t=await g.get(`${m.value}/cards`);c.value=t.data}catch(t){console.log(t)}},T=t=>{y.value={...c.value[t]},C.value=y.value.image,p.value=c.value[t].id,h.value=!0},V=t=>{p.value=c.value[t].id,i.value=!0},R=async()=>{try{if(p.value){if((await g.delete(m.value==="admin"?"admin/card":"card",{data:{card_id:p.value}})).data.affected===1){d.success("Card deleted successfully"),i.value=!1,x();return}d.error("Something went wrong. Please try again later")}}catch(t){d.error(t.response.data.error),i.value=!1}},A=async(t,_,a)=>{try{let s="";const l=new FormData;if(_.file&&(l.append("image",_.file,_.name),s="/image"),l.append("id",a.id.toString()),l.append("name",t.name),l.append("private",t.private.toString()),(await g.patch(m.value==="admin"?`admin/card${s}`:`card${s}`,l,{headers:{"Content-Type":"multipart/form-data"}})).status===200){d.success("Card updated successfully"),x(),h.value=!1;return}d.error("Something went wrong. Please try again later")}catch(s){d.error("Something went wrong. Please try again later",s)}};return(t,_)=>(n(),r(b,null,[e("div",Y,[h.value?(n(),r("div",ce,[v(D,null,{default:u(()=>[w("Edit Card")]),_:1}),v(B,{onSendData:A,successResponse:$.value,cardData:y.value,imageFile:C.value,edit:!0,onCloseEditMode:N},null,8,["successResponse","cardData","imageFile"])])):(n(),r("div",q,[v(D,null,{default:u(()=>[w("My Cards")]),_:1}),e("div",z,[e("div",J,[e("div",K,[e("div",Q,[e("div",W,[e("table",X,[e("thead",Z,[e("tr",null,[(n(!0),r(b,null,M(F.value,(a,s)=>(n(),r("th",{scope:"col",key:s,class:"py-3 px-6 text-xs font-medium tracking-wider text-left uppercase text-gray-400"},f(a),1))),128)),ee])]),e("tbody",te,[(n(!0),r(b,null,M(c.value,(a,s)=>(n(),r("tr",{class:"hover:bg-gray-700",key:`gamme_${a.id}`},[e("td",se,f(s+1),1),e("td",ae,f(a.name),1),e("td",oe,[e("img",{src:U(H)(a.image),alt:a.name,class:"w-20 h-32"},null,8,le)]),e("td",ne,f(a.private?"YES":"NO"),1),e("td",re,[e("button",{class:"text-blue-500 hover:underline",onClick:l=>T(s)}," View Details ",8,de),e("button",{class:"text-red-500 hover:underline ml-2",onClick:l=>V(s)}," Delete ",8,ie)])]))),128))])])])])])])])]))]),v(I,{modalOpen:i.value,onCloseModal:k},{modal_header:u(()=>[w(" Are you sure? ")]),body:u(()=>[ue]),modal_footer:u(()=>[e("button",{onClick:R,class:"flex w-full items-center justify-center rounded-md border border-transparent bg-red-500 text-white px-8 py-3 text-base font-medium hover:bg-red-600 hover:text-white md:py-3 md:px-10 md:text-lg"}," Delete "),e("button",{onClick:k,class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-gray-600 hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Cancel ")]),_:1},8,["modalOpen"])],64))}});export{ge as _};
