import{d as F,u as H,r as f,a as J,v as $,o,c as r,i as e,j as C,l,m as u,C as c,k as i,E as h,J as _,H as x,I as b}from"./index.14bb9b25.js";import{M as Z}from"./MyTitle.c7a8da49.js";import{M as V}from"./Modal.cb2be4ab.js";import{c as d,u as j,r as v,m as G,s as K}from"./index.esm.099a0bc5.js";import{a as L}from"./axiosUser.1214f98e.js";import"./_plugin-vue_export-helper.cdc0426e.js";const Q={class:"w-full overflow-x-auto px-4"},R={class:"flex justify-center mt-10"},W={class:"lg:w-6/12 w-10-12 bg-dark rounded-lg p-4"},X={class:"text-white text-center"},Y={class:"text-primary"},ee={class:"text-white text-center mt-4"},se={class:"text-primary"},te=e("div",{class:"text-white text-center mt-4"},[u(" Password: "),e("span",{class:"text-primary"}," ************* ")],-1),ae={class:"mt-4 flex"},oe={class:"mb-3"},re=e("label",{for:"username",class:"block text-sm font-medium"},"Username",-1),de={class:"mt-1"},ne=e("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-gray-600 hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Cancel ",-1),le={class:"mb-3"},me=e("label",{for:"old_password",class:"block text-sm font-medium"},"Old Password",-1),ce={class:"mt-1"},ie={class:"mb-3"},ue=e("label",{for:"new_password",class:"block text-sm font-medium"},"New Password",-1),pe={class:"mt-1"},we={class:"mb-3"},xe=e("label",{for:"confirm_password",class:"block text-sm font-medium"},"Confirm Password",-1),fe={class:"mt-1"},he=e("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-gray-600 hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Cancel ",-1),$e=F({__name:"SettingsView",setup(_e){const m=H(),y=f(!1),g=f(!1),P=J(),U=$(()=>P.$state.user),p=f({username:""}),a=f({old_password:"",new_password:"",confirm_password:""}),M=()=>{y.value=!1},O=()=>{p.value.username=U.value.username,y.value=!0},D=async()=>{if(await k.value.$validate(),!k.value.$error)try{const n=await L.patch("user/edit/username",{username:p.value.username});if(n.status===200){P.decodeToken(n.data.token),m.success("Username updated successfully"),M();return}m.error("Something went wrong.")}catch(n){m.error(n.response.data.error)}},S=()=>{T(),g.value=!1},N=d.regex(/^(?=.*[A-Z]).*$/),A=d.regex(/^(?=.*[a-z])/),B=d.regex(/^(?=.*[0-9])/),E=d.regex(/[-._!"`'#%&,:;<>=@{}~\$\(\)\*\+\/\\\?\[\]\^\|]+/),I=$(()=>({old_password:{required:v},new_password:{required:v,minLength:G(6),passwordUppercase:d.withMessage("The Password must contain at least one Uppercase character.",N),passwordLowercase:d.withMessage("The Password must contain at least one Lowercase character.",A),passwordDigit:d.withMessage("The Password must contain at least one digit.",B),passwordSpecialCharacter:d.withMessage("The Password must have at least one Special Symbol.",E)},confirm_password:{required:v,sameAs:K(a.value.new_password)}})),q=$(()=>({username:{required:v}})),w=j(I,a),k=j(q,p.value),z=async()=>{if(await w.value.$validate(),!w.value.$error){const n={old_password:a.value.old_password,new_password:a.value.new_password};try{const t=await L.patch("user/edit/password",n);T(),t.data.affected===1?m.success("Password updated successfully"):m.error("Something went wrong.")}catch(t){m.error(t.response.data.error)}S()}},T=()=>{a.value.confirm_password="",a.value.new_password="",a.value.old_password=""};return(n,t)=>(o(),r(x,null,[e("div",Q,[C(Z,null,{default:l(()=>[u("My Personal Info")]),_:1}),e("div",R,[e("div",W,[e("div",X,[u(" Username: "),e("span",Y,c(i(U).username),1)]),e("div",ee,[u(" Email: "),e("span",se,c(i(U).email),1)]),te,e("div",ae,[e("button",{onClick:O,class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-2 md:px-10"}," Change Username "),e("button",{onClick:t[0]||(t[0]=s=>g.value=!0),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-2 md:px-10 ml-2"}," Change Password ")])])])]),C(V,{modalOpen:y.value,onCloseModal:M},{modal_header:l(()=>[u(" Change Username ")]),body:l(()=>[e("div",oe,[re,e("div",de,[h(e("input",{id:"username",type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>p.value.username=s),class:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-secondary focus:outline-none sm:text-sm"},null,512),[[_,p.value.username]])]),(o(!0),r(x,null,b(i(k).username.$errors,s=>(o(),r("div",{key:s.$uid,class:"text-rose-700 text-base font-medium mt-1 px-2"},c(s.$message),1))),128))])]),modal_footer:l(()=>[e("button",{onClick:D,class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary text-white px-8 py-3 text-base font-medium hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg"}," Update Username "),ne]),_:1},8,["modalOpen"]),C(V,{modalOpen:g.value,onCloseModal:S},{modal_header:l(()=>[u(" Change Password ")]),body:l(()=>[e("div",le,[me,e("div",ce,[h(e("input",{id:"old_password",type:"password","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.old_password=s),class:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-secondary focus:outline-none sm:text-sm"},null,512),[[_,a.value.old_password]])]),(o(!0),r(x,null,b(i(w).old_password.$errors,s=>(o(),r("div",{key:s.$uid,class:"text-rose-700 text-base font-medium mt-1 px-2"},c(s.$message),1))),128))]),e("div",ie,[ue,e("div",pe,[h(e("input",{id:"new_password",type:"password","onUpdate:modelValue":t[3]||(t[3]=s=>a.value.new_password=s),class:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-secondary focus:outline-none sm:text-sm"},null,512),[[_,a.value.new_password]])]),(o(!0),r(x,null,b(i(w).new_password.$errors,s=>(o(),r("div",{key:s.$uid,class:"text-rose-700 text-base font-medium mt-1 px-2"},c(s.$message),1))),128))]),e("div",we,[xe,e("div",fe,[h(e("input",{id:"confirm_password",type:"password","onUpdate:modelValue":t[4]||(t[4]=s=>a.value.confirm_password=s),class:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-secondary focus:outline-none sm:text-sm"},null,512),[[_,a.value.confirm_password]])]),(o(!0),r(x,null,b(i(w).confirm_password.$errors,s=>(o(),r("div",{key:s.$uid,class:"text-rose-700 text-base font-medium mt-1 px-2"},c(s.$message),1))),128))])]),modal_footer:l(()=>[e("button",{onClick:z,class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary text-white px-8 py-3 text-base font-medium hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg"}," Update Password "),he]),_:1},8,["modalOpen"])],64))}});export{$e as default};
