import{d as S,o,c as g,h as u,G as L,H as q,B as T,C,L as B,F as A,K as x,w as t,k as $,i as l,e as y,t as W,j as n,J as se,a as ae,u as le,m as oe,n as re,R as j}from"./index.afe561d7.js";import{_ as F}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as H}from"./PrimaryButton.vue_vue_type_script_setup_true_lang.b18fe85a.js";import{_ as M}from"./CheckBoxField.vue_vue_type_script_setup_true_lang.529dfc7b.js";import{_ as D}from"./InputField.vue_vue_type_script_setup_true_lang.5253394b.js";import{_ as U,R as ne,a as ue}from"./RemoveButton.6a93848e.js";import{M as N,u as ie}from"./Modal.97e016a9.js";import{_ as de}from"./TableForm.vue_vue_type_script_setup_true_lang.101ceb62.js";import{u as me}from"./TableStore.42415c70.js";import{u as pe,s as E,T as I}from"./socket.2cb9fbe2.js";import{u as J,r as K}from"./index.esm.d85b393f.js";import{M as ce}from"./MyTitle.f241421f.js";import"./PreLoader.60a7f53a.js";import"./axiosUser.fe64fb1c.js";const fe={class:"mx-auto mt-4"},ve={class:"flex flex-col"},_e={class:"overflow-x-auto shadow-md sm:rounded-lg"},be={class:"inline-block min-w-full align-middle"},ye={class:"overflow-hidden"},ge={class:"min-w-full divide-y table-fixed divide-gray-700"},we={class:"bg-gray-700"},he={key:0,scope:"col",class:"p-4"},xe=u("span",{class:"sr-only"},"Edit",-1),$e=[xe],Te={class:"divide-y bg-dark divide-gray-700"},ke=S({__name:"DarkTable",props:{tableHeaders:{type:Array,required:!0},actions:{type:Boolean,default:!1}},setup(i){return(v,p)=>(o(),g("div",fe,[u("div",ve,[u("div",_e,[u("div",be,[u("div",ye,[u("table",ge,[u("thead",we,[u("tr",null,[(o(!0),g(L,null,q(i.tableHeaders,(d,c)=>(o(),g("th",{scope:"col",key:c,class:"py-3 px-6 text-xs font-medium tracking-wider text-left uppercase text-gray-400"},T(d),1))),128)),i.actions?(o(),g("th",he,$e)):C("",!0)])]),u("tbody",Te,[B(v.$slots,"default")])])])])])])]))}}),Ce={},Me={class:"container 2xl:w-4/6 px-4 py-4"};function Se(i,v){return o(),g("div",Me,[B(i.$slots,"default")])}const z=F(Ce,[["render",Se]]),Oe={},Pe={class:"hover:bg-gray-700 transition duration-150"};function Ve(i,v){return o(),g("tr",Pe,[B(i.$slots,"default")])}const Ee=F(Oe,[["render",Ve]]),k=S({__name:"DarkTableCell",props:{textColor:{type:String,default:"white"}},setup(i){const v=i,p=()=>`text-${v.textColor}`;return(d,c)=>(o(),g("td",{class:A(["py-4 px-6 text-sm font-medium whitespace-nowrap",p()])},[B(d.$slots,"default")],2))}}),Be=S({__name:"CreateTableModal",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],setup(i,{emit:v}){return me().fetchGames(),(d,c)=>(o(),x(N,{modalOpen:i.isModalOpen,onCloseModal:c[0]||(c[0]=f=>d.$emit("closeModal"))},{modal_header:t(()=>[$(" Create Table ")]),body:t(()=>[l(de)]),_:1},8,["modalOpen"]))}}),Ge=S({__name:"ModalSetGuestUsername",props:{isModalOpen:{type:Boolean,required:!0},username:{type:String,default:""}},emits:["closeModal","registerGuest"],setup(i,{emit:v}){const p=i,d=y({username:""});p.username&&(d.value.username=p.username);const c=W(()=>({username:{required:K}})),f=J(c,d),w=()=>{f.value.$validate(),f.value.$error||v("registerGuest",d.value.username)};return(m,a)=>(o(),x(N,{modalOpen:i.isModalOpen,onCloseModal:a[3]||(a[3]=_=>m.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[$(" Set Nickname ")]),body:t(()=>[l(M,null,{default:t(()=>[l(D,{title:"Nickname",input:d.value.username,onChange:a[0]||(a[0]=_=>d.value.username=_),errors:n(f).username.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[u("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:a[1]||(a[1]=_=>m.$emit("closeModal"))}," Close "),u("button",{onClick:a[2]||(a[2]=_=>w()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),Re=S({__name:"ModalSetPasswordTable",props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal","setPasswordTable"],setup(i,{emit:v}){const p=y({password:""}),d=W(()=>({password:{required:K}})),c=J(d,p),f=()=>{c.value.$validate(),c.value.$error||v("setPasswordTable",p.value.password)};return(w,m)=>(o(),x(N,{modalOpen:i.isModalOpen,onCloseModal:m[3]||(m[3]=a=>w.$emit("closeModal")),class:"z-[2147483645]"},{modal_header:t(()=>[$(" Password Table ")]),body:t(()=>[l(M,null,{default:t(()=>[l(D,{title:"Table Password",input:p.value.password,onChange:m[0]||(m[0]=a=>p.value.password=a),errors:n(c).password.$errors},null,8,["input","errors"])]),_:1})]),modal_footer:t(()=>[u("button",{class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2",onClick:m[1]||(m[1]=a=>w.$emit("closeModal"))}," Close "),u("button",{onClick:m[2]||(m[2]=a=>f()),class:"flex w-full items-center justify-center rounded-md border border-transparent bg-primary px-8 py-3 text-base font-medium text-white hover:bg-secondary hover:text-white md:py-3 md:px-10 md:text-lg ml-2"}," Submit ")]),_:1},8,["modalOpen"]))}}),Ie={key:0},Le=u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-red-500",viewBox:"0 0 16 16"},[u("path",{d:"M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"})],-1),Ae=[Le],De={key:1},Ne=u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"w-6 h-6 text-primary",viewBox:"0 0 16 16"},[u("path",{d:"M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"})],-1),je=[Ne],st=S({__name:"LobbyRoom",setup(i){const{width:v,height:p}=ie(),d=y(parseInt({VITE_API_URL:"be.psillovits.com",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_GAME_HEIGHT)),c=y(parseInt({VITE_API_URL:"be.psillovits.com",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_GAME_WIDTH)),f=y(!1),w=y(!1),m=se(),a=ae(),_=y([]),O=y([]),Y=le(),h=pe(),G=y(""),R=y(!1);oe(()=>{a.user.id||(f.value=!0),E.emit("findAllOnlineTable",{},r=>{_.value=O.value=r}),E.on("addNewTable",r=>{r.table_users=[],_.value.unshift(r)}),E.on("removeOldTable",r=>{_.value=O.value=_.value.filter(e=>e.id!==r)}),E.on("getTableUsers",r=>{const e=_.value.map(s=>s.id).indexOf(r.id);e!==-1&&(_.value[e].table_users=r.table_users)})});const Q=()=>{if(h.table){if(!a.user.id){f.value=!0;return}h.table.private?w.value=!0:m.push({name:"room",params:{id:h.table.public_url}})}},X=async r=>{await h._validateTablePassword(r).then(e=>{e.status===200?h.table&&(w.value=!1,m.push({name:"room",params:{id:h.table.public_url}})):(w.value=!1,Y.error("Wrong Password"))})},Z=y(["Table","Game","Players","Private","creator","status"]),P=y(-1),ee=r=>{a.registerGuest(r).then(()=>{f.value=!1})},te=(r,e)=>{P.value===r?(P.value=-1,h.table=null):(P.value=r,h.table=e)};return re(()=>G.value,r=>{O.value=_.value.filter(e=>e.name.toLocaleLowerCase().includes(r.toLocaleLowerCase()))}),(r,e)=>(o(),g(L,null,[n(v)>c.value&&n(p)>d.value?(o(),x(z,{key:0},{default:t(()=>[l(M,{justify:"between",items:"end",class:"mb-8"},{default:t(()=>[l(ce,null,{default:t(()=>[$("Lobby")]),_:1}),n(a).user.email===null?(o(),g("button",{key:0,class:"bg-black text-white h-12 px-4 rounded-xl hover:bg-primary transition duration-300",onClick:e[0]||(e[0]=s=>f.value=!0)},T(n(a).user.username?"Change Nickname":"Add Nickname"),1)):C("",!0)]),_:1}),l(ue,{all:2,class:"mt-3 px-2"},{default:t(()=>[l(U,{all:1},{default:t(()=>[l(D,{input:G.value,placeholder:"Search a Table..",onChange:e[1]||(e[1]=s=>G.value=s)},null,8,["input","placeholder"])]),_:1}),l(U,{all:1},{default:t(()=>[l(M,{justify:"center",gap:2},{default:t(()=>{var s,V;return[n(a).user.role!==n(j).guest?(o(),x(H,{key:0,title:"Create Table",onClick:e[2]||(e[2]=b=>R.value=!0)})):C("",!0),l(H,{title:"Join Table",disable:P.value===-1,onClick:e[3]||(e[3]=b=>Q())},null,8,["disable"]),((V=(s=n(h).table)==null?void 0:s.creator)==null?void 0:V.id)===n(a).user.id?(o(),x(ne,{key:1,onClick:e[4]||(e[4]=b=>n(h)._removeTable())})):C("",!0)]}),_:1})]),_:1})]),_:1}),O.value.length>0?(o(),x(ke,{key:0,"table-headers":Z.value},{default:t(()=>[(o(!0),g(L,null,q(O.value,(s,V)=>(o(),x(Ee,{key:`lobby-row-${s.id}`,onClick:b=>te(V,s),class:A(P.value===V?"bg-gray-700":"")},{default:t(()=>[l(k,null,{default:t(()=>[$(T(s.name),1)]),_:2},1024),l(k,null,{default:t(()=>{var b;return[$(T((b=s.game)==null?void 0:b.name),1)]}),_:2},1024),l(k,null,{default:t(()=>{var b;return[$(T((b=s.table_users)!=null&&b.length?s.table_users.length:0),1)]}),_:2},1024),l(k,null,{default:t(()=>[l(M,null,{default:t(()=>[s.private?(o(),g("div",Ie,Ae)):(o(),g("div",De,je))]),_:2},1024)]),_:2},1024),l(k,null,{default:t(()=>{var b;return[$(T((b=s.creator)==null?void 0:b.username),1)]}),_:2},1024),l(k,{class:A([[s.status===n(I).WAITING?"text-blue-500":"",s.status===n(I).PLAYING?"text-primary":"",s.status===n(I).PAUSE?"text-yellow-500":""],"capitalize"])},{default:t(()=>[$(T(s.status),1)]),_:2},1032,["class"])]),_:2},1032,["onClick","class"]))),128))]),_:1},8,["table-headers"])):C("",!0)]),_:1})):(o(),x(z,{key:1},{default:t(()=>[l(M,{class:"bg-red-500 p-4",justify:"center",items:"center"},{default:t(()=>[$(" The game is supported on desktop computers ")]),_:1})]),_:1})),n(a).user.role!==n(j).guest?(o(),x(Be,{key:2,"is-modal-open":R.value,onCloseModal:e[5]||(e[5]=()=>R.value=!1)},null,8,["is-modal-open"])):C("",!0),l(Ge,{"is-modal-open":f.value,username:n(a).user.username?n(a).user.username:"",onCloseModal:e[6]||(e[6]=s=>f.value=!1),onRegisterGuest:e[7]||(e[7]=s=>ee(s))},null,8,["is-modal-open","username"]),l(Re,{"is-modal-open":w.value,onCloseModal:e[8]||(e[8]=s=>w.value=!1),onSetPasswordTable:e[9]||(e[9]=s=>X(s))},null,8,["is-modal-open"])],64))}});export{st as default};
